{"version":3,"file":"thunderEvents.min.mjs","sources":["../lib/constants.js","../lib/utilities.js","../lib/state.js","../lib/thunderEvents.js","../lib/uiComponents/ProgramGuideNative/componentUtils.js","../lib/uiComponents/ProgramGuideNative/getStyles.js","../lib/uiComponents/ProgramGuideNative/render/renderSortDialog.js","../lib/uiComponents/ProgramGuideNative/render/renderEventDialog.js","../lib/uiComponents/ProgramGuideNative/render/renderByLocation.js","../lib/uiComponents/ProgramGuideNative/render/renderByTime.js","../lib/uiComponents/ProgramGuideNative/render/renderFavorites.js","../lib/uiComponents/ProgramGuideNative/render/renderSearchResults.js","../lib/uiComponents/ProgramGuideNative/render/renderFloorPlan.js","../lib/uiComponents/ProgramGuideNative/render/renderAsList.js","../lib/uiComponents/ProgramGuideNative/render/dialog-polyfill.js","../lib/uiComponents/ProgramGuideNative/render/renderMenu.js","../lib/uiComponents/ProgramGuideNative/render/index.js","../lib/uiComponents/ProgramGuideNative/render/renderSearchBar.js","../lib/uiComponents/ProgramGuideNative/actions/addFavorite.js","../lib/uiComponents/ProgramGuideNative/actions/removeFavorite.js","../lib/uiComponents/ProgramGuideNative/actions/toggleHiddenLocation.js","../lib/uiComponents/ProgramGuideNative/actions/toggleAllHiddenLocations.js","../lib/uiComponents/ProgramGuideNative/actions/handleEsc.js","../lib/uiComponents/ProgramGuideNative/actions/handleHashChange.js","../lib/uiComponents/ProgramGuideNative/actions/showFloorPlan.js","../lib/uiComponents/ProgramGuideNative/actions/toggleFloorPlanInteractive.js","../lib/uiComponents/ProgramGuideNative/actions/toggleHeaders.js","../lib/uiComponents/ProgramGuideNative/actions/toggleSortDialog.js","../lib/uiComponents/ProgramGuideNative/actions/openEventDialog.js","../lib/uiComponents/ProgramGuideNative/actions/closeEventDialog.js","../lib/uiComponents/ProgramGuideNative/actions/selectActiveLocation.js","../lib/uiComponents/ProgramGuideNative/actions/selectActiveDay.js","../lib/uiComponents/ProgramGuideNative/actions/selectActiveTime.js","../lib/uiComponents/ProgramGuideNative/actions/selectSortBy.js","../lib/uiComponents/ProgramGuideNative/actions/changeSearch.js","../lib/uiComponents/ProgramGuideNative/actions/search.js","../lib/uiComponents/ProgramGuideNative/actions/showFloorPlanMessage.js","../lib/uiComponents/ProgramGuideNative/actions/maximize.js","../lib/uiComponents/ProgramGuideNative/actions/undoStateChange.js","../lib/uiComponents/ProgramGuideNative/actions/print.js","../lib/uiComponents/HTMLElement.js","../lib/exports.js","../lib/uiComponents/ProgramGuideNative/index.js"],"sourcesContent":["export const DEFAULT_FLOOR_PLAN = {\r\n  title: 'Venue',\r\n  imageSrc: '',\r\n  dimensions: {\r\n    height: 600,\r\n    width: 800,\r\n  },\r\n  clickableAreas: [],\r\n}\r\n\r\nexport const DEFAULT_GUIDE = {\r\n  locations: [],\r\n  events: [],\r\n  floorPlan: DEFAULT_FLOOR_PLAN,\r\n  rollOverTime: '12:00 AM',\r\n}\r\n\r\nconst FAVORITES_KEY = 'FAVORITE_EVENTS'\r\nconst HIDDEN_LOCATIONS_KEY = 'HIDDEN_LOCATIONS'\r\n\r\nexport const DEFAULT_ADD_FAVORITE = async event => {\r\n  const favoriteEvents = JSON.parse(localStorage.getItem(FAVORITES_KEY) || '[]')\r\n  favoriteEvents.push(event)\r\n  const eventsJSON = JSON.stringify(favoriteEvents)\r\n  localStorage.setItem(FAVORITES_KEY, eventsJSON)\r\n  return favoriteEvents\r\n}\r\n\r\nexport const DEFAULT_REMOVE_FAVORITE = async event => {\r\n  const favoriteEvents = JSON.parse(localStorage.getItem(FAVORITES_KEY) || '[]')\r\n  const removeIndex = favoriteEvents.findIndex(({ location: _location, start, name }) => {\r\n    const { location: cLocation, start: cStart, name: cName } = event\r\n    return _location === cLocation && start === cStart && name === cName\r\n  })\r\n  favoriteEvents.splice(removeIndex, 1)\r\n  const eventsJSON = JSON.stringify(favoriteEvents)\r\n  localStorage.setItem(FAVORITES_KEY, eventsJSON)\r\n  return favoriteEvents\r\n}\r\n\r\nexport const DEFAULT_GET_FAVORITES = async () => {\r\n  const favoriteEvents = JSON.parse(localStorage.getItem(FAVORITES_KEY) || '[]')\r\n  return favoriteEvents\r\n}\r\n\r\nexport const DEFAULT_UPDATE_HIDDEN_LOCATIONS = async (hiddenLocations = []) => {\r\n  console.log(hiddenLocations)\r\n  localStorage.setItem(HIDDEN_LOCATIONS_KEY, JSON.stringify(hiddenLocations))\r\n  return hiddenLocations\r\n}\r\n\r\nexport const DEFAULT_GET_HIDDEN_LOCATIONS = async () => {\r\n  const hiddenLocations = JSON.parse(localStorage.getItem(HIDDEN_LOCATIONS_KEY) || '[]')\r\n  return hiddenLocations\r\n}\r\n\r\nexport const DEFAULT_FETCH_DATA = () => Promise.resolve({\r\n  guide: DEFAULT_GUIDE,\r\n  addFavorite: DEFAULT_ADD_FAVORITE,\r\n  getFavorites: DEFAULT_GET_FAVORITES,\r\n  updateHiddenLocations: DEFAULT_UPDATE_HIDDEN_LOCATIONS,\r\n  getHiddenLocations: DEFAULT_GET_HIDDEN_LOCATIONS\r\n})\r\n\r\nconst NOW = Date.now() // date in milliseconds\r\n\r\nconst HOUR = 1000 * 60 * 60 // milliseconds * seconds * minutes\r\n\r\nexport const DEFAULT_EVENT = {\r\n  start: NOW,\r\n  end: NOW + HOUR,\r\n  location: '(not provided)',\r\n  name: '(no name)',\r\n  host: '(not provided)',\r\n  category: '(not provided)',\r\n  description: '(no description)',\r\n}\r\n\r\nexport const DEFAULT_CLICKABLE_AREA = {\r\n  location: '(none)',\r\n  shape: 'rect',\r\n  coords: [],\r\n  href: '#',\r\n  alt: '',\r\n}\r\n\r\nexport const DEFAULT_TIMES = {\r\n  days: [],\r\n  interval: 60,\r\n}\r\n\r\nexport const DEFAULT_BREAKPOINT = '50em'\r\n\r\nexport const NOOP = () => {}\r\n","import { DEFAULT_TIMES, NOOP } from './constants'\r\n\r\nexport const getType = val => {\r\n  if (val === null) return 'null'\r\n  if (typeof val === 'object') return val.constructor.name.toLowerCase()\r\n  return typeof val\r\n}\r\n\r\nexport const checkType = (val, type) => {\r\n  const validString = getType(type) === 'string'\r\n  const validArray = getType(type) === 'array' && type.every(t => getType(t) === 'string')\r\n  if (!validString && !validArray) throw '`checkType()` expects either a string or array of strings in the second argument'\r\n  if (validString) return getType(val) === type\r\n  if (validArray) return type.some(t => getType(val) === t)\r\n}\r\n\r\nexport const isObject = obj => checkType(obj, 'object')\r\n\r\nexport const isEmpty = val => checkType(val, ['undefined', 'null'])\r\n\r\nexport const contains = (val, search) => {\r\n  const valIsString = checkType(val, 'string')\r\n  const valIsArray = checkType(val, 'array') && val.every(t => checkType(t, 'string'))\r\n  const validSearch = checkType(search, ['string', 'regexp'])\r\n  if (!valIsArray && !valIsString) throw '`contains()` expects either a string or array of strings in the first argument'\r\n  if (!validSearch) throw '`contains()` expects either a string or regular expression in the second argument'\r\n  if (valIsArray) return val.some(v => v.search(search) !== -1)\r\n  if (valIsString) return val.search(search) !== -1\r\n}\r\n\r\nexport const parseLocationHash = location =>\r\n  `#View-Location-${location.replace(/[^a-zA-Z0-9]+/g, '-').replace(/^-|-$/g, '')}`\r\n\r\n/**\r\n * Returns a function which gets a field from a given object, unless it's empty,\r\n * in which case it gets that same field from a fallback object.\r\n * @param {object} fallbackObj - The object to be referenced when a field is empty on the original object.\r\n * @param {function} onFallback - An optional callback to run when the fallback is used.\r\n * @param {object} _altTypes - A mapping of fields to acceptable alternative types.\r\n * @returns {function} - Used to get the value from a provided key.\r\n */\r\nexport const useFallback = (fallbackObj, onFallback = NOOP, _altTypes = {}) => {\r\n  if (!isObject(fallbackObj)) throw '`useFallback()` expects an object in the first argument'\r\n  if (!checkType(onFallback, 'function')) throw '`useFallback()` expects a function in the second argument'\r\n  if (!isObject(_altTypes)) throw '`useFallback()` expects an object in the third argument'\r\n  return (obj, key) => {\r\n    const fallbackValue = fallbackObj[key]\r\n    const valid = isObject(obj)\r\n    const value = valid ? obj[key] : null\r\n    const empty = isEmpty(value)\r\n    const type = getType(value)\r\n    const altTypes = _altTypes[key]\r\n    const altTypesArr = checkType(altTypes, 'array') ? altTypes : (checkType(altTypes, 'string') ? [altTypes] : [])\r\n    const mismatch = type !== getType(fallbackValue) && !altTypesArr.some(t => t === type)\r\n    if (!valid || empty || mismatch) {\r\n      const status = !valid ? 'invalid' : (empty ? 'empty' : 'mismatch')\r\n      onFallback(status, key)\r\n      return fallbackValue\r\n    }\r\n    return value\r\n  }\r\n}\r\n\r\n/**\r\n * Returns a function which casts any value to the same structure as the provided object (the type).\r\n * @param {object} type - An object which serves as the (shallow) structure constraints.\r\n * @param {string} name - The optional name of the type for logging purposes.\r\n * @param {object} altTypes - A mapping of fields to acceptable alternative types.\r\n * @returns {function} - Used to cast a provided value to the given type.\r\n */\r\nexport const useCast = (type, name = 'object', altTypes = {}) => {\r\n  if (!isObject(type)) throw 'You may only cast to custom object types'\r\n  return obj => {\r\n    if (!isObject(obj)) return type\r\n    const getValue = useFallback(type, (status, key) => {\r\n      if (status === 'invalid') console.warn(`The provided ${name} is not a valid object.`)\r\n      else if (status === 'mismatch') console.warn(`The \\`${key}\\` field expected type \\`${getType(type[key])}\\` but got \\`${getType(obj[key])}\\`.`)\r\n      else if (status === 'empty') console.warn(`The provided ${name} did not have the \\`${key}\\` field.`)\r\n    }, altTypes)\r\n    return Object.keys(type).reduce((castObj, key) => {\r\n      castObj[key] = getValue(obj, key)\r\n      return castObj\r\n    }, {})\r\n  }\r\n}\r\n\r\nexport const checkFilterType = (filter = {}) => {\r\n  if ('after' in filter && !checkType(filter.after, ['number', 'date'])) throw 'The `after` field expects a number or date'\r\n  if ('before' in filter && !checkType(filter.before, ['number', 'date'])) throw 'The `before` field expects a number or date'\r\n  if ('locations' in filter && !checkType(filter.locations, 'array')) throw 'The `locations` field expects an array'\r\n  if ('search' in filter && !checkType(filter.search, ['string', 'regexp'])) throw 'The `search` field expects a string or regular expression'\r\n  return true // indicate success\r\n}\r\n\r\n/**\r\n * This is the most efficient way to clear HTML, much faster than innerHTML.\r\n * @param {HTMLElement} element - the DOM element we want to empty\r\n */\r\nexport const clearHTML = element => {\r\n  let i = element.childNodes.length\r\n  while (i--) { element.removeChild(element.lastChild) }\r\n}\r\n\r\n/**\r\n * This is the most efficient way to parse HTML, much faster than innerHTML.\r\n *\r\n * @param {string} htmlStr - a string containing only raw HTML\r\n */\r\nexport const parseHTML = htmlStr => {\r\n  const range = document.createRange()\r\n  range.selectNode(document.body) // required in Safari\r\n  return range.createContextualFragment(htmlStr)\r\n}\r\n\r\n/**\r\n * This helps us avoid trailing commas when mapping template literals.\r\n * @param {Array} arr - the array to iterate\r\n * @param {function} callback - the callback for each iteration; should return a string or stringifiable value\r\n */\r\nexport const mapString = (arr, callback) => arr.map(callback).join('')\r\n\r\n/**\r\n * Rounds a date to the nearest given minute\r\n * @param {Date|number|string} _date - The date to round (or anything that can be parsed as a date)\r\n * @param {number} nearestMinute - The nearest minute to round to (15 by default)\r\n */\r\nexport const roundMinutes = (_date, nearestMinute = 15) => {\r\n  const date = new Date(_date)\r\n  const roundedMinutes = Math.round(date.getMinutes() / nearestMinute) * nearestMinute\r\n  date.setMinutes(roundedMinutes)\r\n  return date\r\n}\r\n\r\nexport const WholeNumber = num => Number(num.toFixed())\r\n\r\n/**\r\n * Gets the name of the day based on the index (typically returned by `date.getDay()`)\r\n * @param {number} idx - The index of the day of the week\r\n * @param {boolean} short - Whether to abbreviate the day names or not\r\n * @returns {string} - The name of the day of the week\r\n */\r\nexport const getDay = (idx, short = false) => {\r\n  const days = [\r\n    'Sunday',\r\n    'Monday',\r\n    'Tuesday',\r\n    'Wednesday',\r\n    'Thursday',\r\n    'Friday',\r\n    'Saturday',\r\n  ]\r\n  const shortDays = [\r\n    'Sun',\r\n    'Mon',\r\n    'Tues',\r\n    'Wed',\r\n    'Thurs',\r\n    'Fri',\r\n    'Sat',\r\n  ]\r\n  return short ? shortDays[idx] : days[idx]\r\n}\r\n\r\nexport const getDateInfo = _date => {\r\n  const date = new Date(_date)\r\n  return {\r\n    time: date.toLocaleTimeString('en-US', { timeStyle: 'short' }),\r\n    day: getDay(date.getDay()),\r\n    date: date.toLocaleDateString(),\r\n  }\r\n}\r\n\r\n/**\r\n * Generates a string representing javascript, which can be used in the\r\n * HTML templates of native web components.\r\n * \r\n * EXAMPLE:\r\n * ```js\r\n *   const open = true\r\n *   const html = `<button onclick=\"this.getRootNode().host.openDialog(${open})\">Click me</button>`\r\n * ```\r\n * \r\n * versus\r\n * \r\n * ```js\r\n *   const open = true\r\n *   const html = `<button onclick=\"${runMethod('openDialog', open)}\">Click me</button>`\r\n * ```\r\n * \r\n * @param {string} name - The name of the component method to run\r\n * @param {...*} args - The arguments to be used in the function call (objects will be converted to JSON and encoded as a URI component)\r\n * @returns {string} - A string representing JavaScript code\r\n */\r\nexport const runMethod = (name, ...args) => {\r\n\r\n  const mapType = value => {\r\n\r\n    // preserve keywords that can be used in html attribute handlers\r\n    if (value === 'event' || value === 'this') return value\r\n\r\n    // handle the string rendering of arguments based on their type\r\n    const type = getType(value)\r\n    const map = {\r\n\r\n      // stringify objects to avoid [object Object] and encode to avoid double quote conflicts\r\n      object: `\\`${encodeURIComponent(JSON.stringify(value))}\\``,\r\n\r\n      // wrap strings in backticks in case they're multiline\r\n      string: `\\`${value}\\``,\r\n\r\n      // all other types are rendered without quotes\r\n      default: String(value)\r\n    }\r\n\r\n    return map[type] || map.default\r\n  }\r\n\r\n  return `this.getRootNode().host.${name}(${args.length ? `${[...args].map(mapType)}` : 'event'})`\r\n}\r\n\r\nexport const getEventId = ({ location, name, start: _start }) => {\r\n  const snip = s => s.replace(/[^a-zA-Z0-9]/g, '')\r\n  const date = new Date(_start)\r\n  const start = `${date.toLocaleDateString()}-${date.toLocaleTimeString()}`\r\n  return `${snip(location)}-${snip(name)}-${snip(start)}`\r\n}\r\n\r\nexport const search = (_input, _text) => {\r\n\r\n  // * replace variation characters (for example, é becomes e)\r\n  // * remove anything that isn't alphanumeric (including spaces)\r\n  //     ^ this lets \"megaman\" match \"mega man\"\r\n  // * use lower case for case-insensitive search\r\n  const formatForSimilarMatch = str => str\r\n    ?.normalize('NFD')\r\n    .replace(/\\p{Diacritic}/gu, '')\r\n    .replace(/[^a-zA-Z0-9]/g, '')\r\n    .toLowerCase()\r\n\r\n  // first try matching the entire query\r\n  const input = formatForSimilarMatch(_input)\r\n  const text = formatForSimilarMatch(_text)\r\n  if (text.search(input) !== -1) return true\r\n  if (input.search(text) !== -1) return true\r\n\r\n  // if that fails, try each word\r\n  return _input.split(/\\s+/g).some(input =>\r\n    text.search(formatForSimilarMatch(input)) !== -1)\r\n}\r\n\r\nexport const trim = (str, max = 40) => str.length > max ? str.slice(0, max - 4) + '...' : str\r\n\r\nexport const getMarkerCoords = (marker, clickableAreas) => {\r\n  const clickableArea = clickableAreas.find(({ location }) => marker === location)\r\n  const allX = clickableArea.coords.filter((_, idx) => idx % 2 === 0)\r\n  const allY = clickableArea.coords.filter((_, idx) => idx % 2 !== 0)\r\n  const minX = Math.min(...allX)\r\n  const minY = Math.min(...allY)\r\n  const maxX = Math.max(...allX)\r\n  const maxY = Math.max(...allY)\r\n  const x = (minX + maxX) / 2\r\n  const y = (minY + maxY) / 2\r\n  return [x, y]\r\n}\r\n\r\nexport const getLastTimeInThreshold = (currentDate, allDates, threshold = '12:00 AM') => {\r\n  const lastInCurrentDay = Math.max(...allDates.filter(t => t.getDate() === currentDate.getDate()))\r\n  if (threshold === '12:00 AM') return new Date(lastInCurrentDay)\r\n  const nextDate = new Date(currentDate)\r\n  nextDate.setDate(currentDate.getDate() + 1)\r\n  nextDate.setTime(new Date(`${nextDate.toLocaleDateString()} ${threshold}`).getTime())\r\n  const allTimesNextDay = allDates.filter(t => t.getDate() === nextDate.getDate())\r\n  const lastInThreshold = Math.max(...allTimesNextDay.filter(t => t.getTime() <= nextDate.getTime()))\r\n  return new Date(lastInThreshold > 0 ? lastInThreshold : lastInCurrentDay)\r\n}\r\n\r\n/** A useful function for comparing and sorting dates.\r\n * @param {String|Date} prevDate - The previous date to compare\r\n * @param {String|Date} nextDate - The next date to compare\r\n * @returns {Number} - Sort order (-1 = before, 0 = same date, 1 = after)\r\n */\r\nexport const compareDates = (prevDate, nextDate) => {\r\n  const prevTime = new Date(prevDate).getTime()\r\n  const nextTime = new Date(nextDate).getTime()\r\n  const before = prevTime < nextTime\r\n  const after = prevTime >= nextTime\r\n  return before ? -1 : after ? 1 : 0\r\n}\r\n\r\nexport const getToday = state => {\r\n  const { days } = state.times || DEFAULT_TIMES\r\n  const { day: nowDay, date: nowDate } = getDateInfo(Date.now())\r\n  const dayKeys = Object.keys(days)\r\n  const getBeforeOrAfter = () => {\r\n    const allDates = dayKeys.map(dayKey => new Date(dayKey))\r\n    const beforeDates = allDates.filter(day => Date.now() < day.getTime())\r\n    const afterDates = allDates.filter(day => Date.now() > day.getTime())\r\n    beforeDates.sort(compareDates)\r\n    afterDates.sort(compareDates)\r\n    const isBefore = beforeDates.length > 0\r\n    const currentDate = isBefore ? beforeDates[0] : afterDates[afterDates.length - 1]\r\n    const { day, date } = getDateInfo(currentDate)\r\n    return `${day} ${date}`\r\n  }\r\n  const currentDay = dayKeys.find(day => day === `${nowDay} ${nowDate}`) ?? getBeforeOrAfter()\r\n  return currentDay\r\n}\r\n","import { DEFAULT_ADD_FAVORITE, DEFAULT_REMOVE_FAVORITE, DEFAULT_GET_FAVORITES, DEFAULT_GUIDE, DEFAULT_UPDATE_HIDDEN_LOCATIONS, DEFAULT_GET_HIDDEN_LOCATIONS } from './constants'\r\nimport { checkType, roundMinutes, getDay, getLastTimeInThreshold } from './utilities'\r\n\r\nexport const state = {\r\n\r\n  // utilities for synchronous actions after loading state\r\n  _hasFetched: false,\r\n  get hasFetched() { return this._hasFetched },\r\n  set hasFetched(bool) {\r\n    this._hasFetched = bool\r\n    if (bool === false) return false\r\n    this.fetchQueue.forEach(resolve => resolve())\r\n    return true\r\n  },\r\n  fetchQueue: [],\r\n  waitForFetch() {\r\n    return new Promise(resolve => {\r\n      if (this.hasFetched) resolve()\r\n      else this.fetchQueue.push(resolve)\r\n    })\r\n  },\r\n\r\n  // default guide\r\n  guide: DEFAULT_GUIDE,\r\n\r\n  // default favorite functionality\r\n  addFavorite: DEFAULT_ADD_FAVORITE,\r\n  removeFavorite: DEFAULT_REMOVE_FAVORITE,\r\n  getFavorites: DEFAULT_GET_FAVORITES,\r\n\r\n  // default location filtering functionality\r\n  updateHiddenLocations: DEFAULT_UPDATE_HIDDEN_LOCATIONS,\r\n  getHiddenLocations: DEFAULT_GET_HIDDEN_LOCATIONS,\r\n\r\n  // get locations and add any missed from events dynamically\r\n  get locations() {\r\n    const locations = this.guide?.locations ?? []\r\n    const events = this.guide?.events ?? []\r\n    return [...events.reduce((locations, event) => {\r\n      if (!checkType(event, 'object')) return locations\r\n      if (!checkType(event.location, 'string')) return locations\r\n      if (!locations.has(event.location)) locations.add(event.location)\r\n      return locations\r\n    }, new Set(locations))]\r\n  },\r\n\r\n  // get times from events dynamically\r\n  get times() {\r\n    const events = this.guide?.events ?? []\r\n    const threshold = this.guide?.rollOverTime ?? '12:00 AM'\r\n    const allTimes = [...events.reduce((times, event) => {\r\n      if (!checkType(event, 'object')) return times\r\n      if (!checkType(event.start, ['number', 'date'])) return times\r\n      if (!checkType(event.end, ['number', 'date'])) return times\r\n      times.add(roundMinutes(event.start))\r\n      times.add(roundMinutes(event.end))\r\n      return times\r\n    }, new Set())].sort((prev, next) => +prev > +next ? 1 : +prev < +next ? -1 : 0)\r\n    const earliestTime = new Date(Math.min(...allTimes))\r\n    const latestTime = new Date(Math.max(...allTimes))\r\n    const interval = allTimes.reduce((interval, date) => {\r\n      if (interval !== 15) {\r\n        const minutes = date.getMinutes()\r\n        if (minutes === 30) interval = 30\r\n        if (minutes === 15 || minutes === 45) interval = 15\r\n      }\r\n      return interval\r\n    }, 0)\r\n    const getTimeObject = date => ({\r\n      date,\r\n      timeString: date.toLocaleTimeString('en-US', { timeStyle: 'short' }),\r\n    })\r\n    const getFullDay = time => `${getDay(time.getDay())} ${time.toLocaleDateString()}`\r\n    let days = { [getFullDay(earliestTime)]: [getTimeObject(earliestTime)] }\r\n    let prevTime = earliestTime\r\n    let currentDay = getFullDay(prevTime)\r\n    let lastTimeInDay = getLastTimeInThreshold(prevTime, allTimes, threshold)\r\n    while (prevTime < latestTime) {\r\n      let currentTime = null\r\n      if (Number(lastTimeInDay) === Number(prevTime)) {\r\n        currentTime = new Date(allTimes.find(time => time > prevTime))\r\n        lastTimeInDay = getLastTimeInThreshold(currentTime, allTimes, threshold)\r\n        currentDay = getFullDay(currentTime)\r\n        days[currentDay] = [getTimeObject(currentTime)]\r\n      } else {\r\n        currentTime = new Date(prevTime)\r\n        const intervalInMs = interval * 1000 * 60\r\n        currentTime.setTime(currentTime.getTime() + intervalInMs)\r\n        days[currentDay].push(getTimeObject(currentTime))\r\n      }\r\n      prevTime = currentTime\r\n    }\r\n    return {\r\n      days,\r\n      interval,\r\n    }\r\n  },\r\n}\r\n","import {\r\n  DEFAULT_FETCH_DATA,\r\n  DEFAULT_EVENT,\r\n  DEFAULT_FLOOR_PLAN,\r\n  DEFAULT_CLICKABLE_AREA,\r\n} from './constants'\r\nimport {\r\n  useCast,\r\n  checkType,\r\n  checkFilterType,\r\n  isObject,\r\n} from './utilities'\r\nimport { state } from './state'\r\n\r\nconst init = async (init = DEFAULT_FETCH_DATA) => {\r\n  const data = await init()\r\n  if (!isObject(data)) throw '`init()` must return an object'\r\n  const { guide } = data\r\n  if (!isObject(guide)) throw 'The `guide` field expects an object'\r\n  if ('events' in guide) {\r\n    if (!checkType(guide.events, 'array')) throw 'The `guide.events` field expects an array'\r\n    const castEvent = useCast(DEFAULT_EVENT, 'event', { start: 'date', end: 'date' })\r\n    state.guide.events = guide.events.map(castEvent)\r\n  }\r\n  if ('floorPlan' in guide) {\r\n    if (!isObject(guide.floorPlan)) throw 'The `guide.floorPlan` field expects an object'\r\n    const castFloorPlan = useCast(DEFAULT_FLOOR_PLAN, 'floor plan')\r\n    const castClickableArea = useCast(DEFAULT_CLICKABLE_AREA, 'clickable area')\r\n    const floorPlan = castFloorPlan(guide.floorPlan)\r\n    state.guide.floorPlan = {\r\n      ...floorPlan,\r\n      clickableAreas: floorPlan.clickableAreas.map(castClickableArea),\r\n    }\r\n  }\r\n  if ('locations' in guide) {\r\n    if (!checkType(guide.events, 'array')) throw 'The `guide.locations` field expects an array'\r\n    state.guide.locations = guide.locations.map(loc => String(loc))\r\n  }\r\n  if ('rollOverTime' in guide) {\r\n    if (!checkType(guide.rollOverTime, 'string')) throw 'The `guide.rollOverTime` field expects a string'\r\n    const timeRegex = /(^((1[0-2])|0?[1-9]):\\d{2} (AM|PM)$)|(^(([0-1]?[0-9])|(2[0-3])):\\d{2}$)/\r\n    if (!timeRegex.test(guide.rollOverTime)) throw 'The `guide.rollOverTime` field expects the string in time format.  Example: \"1:00 PM\" for 12-hours or \"13:00\" for 24-hours'\r\n    state.guide.rollOverTime = guide.rollOverTime\r\n  }\r\n  if ('addFavorite' in data) {\r\n    if (!checkType(data.addFavorite, 'function')) throw 'The `addFavorite` field expects a function'\r\n    state.addFavorite = data.addFavorite\r\n  }\r\n  if ('removeFavorite' in data) {\r\n    if (!checkType(data.removeFavorite, 'function')) throw 'The `removeFavorite` field expects a function'\r\n    state.removeFavorite = data.removeFavorite\r\n  }\r\n  if ('getFavorites' in data) {\r\n    if (!checkType(data.getFavorites, 'function')) throw 'The `getFavorites` field expects a function'\r\n    state.getFavorites = data.getFavorites\r\n  }\r\n  if ('updateHiddenLocations' in data) {\r\n    if (!checkType(data.updateHiddenLocations, 'function')) throw 'The `updateHiddenLocations` field expects a function'\r\n    state.updateHiddenLocations = data.updateHiddenLocations\r\n  }\r\n  if ('getHiddenLocations' in data) {\r\n    if (!checkType(data.getHiddenLocations, 'function')) throw 'The `getHiddenLocations` field expects a function'\r\n    state.getHiddenLocations = data.getHiddenLocations\r\n  }\r\n  state.hasFetched = true\r\n}\r\n\r\nconst getEvents = async (_filters = {}) => {\r\n  await state.waitForFetch()\r\n  if (!isObject(_filters)) throw '`getEvents()` expects an object in the first argument'\r\n  const { include: _include = {}, exclude: _exclude = {} } = _filters\r\n  checkFilterType(_include) // throws if invalid\r\n  checkFilterType(_exclude) // throws if invalid\r\n  const filters = {\r\n    ..._filters,\r\n    include: {\r\n      ..._include,\r\n      after: _include.after ? Number(_include.after) : 0,\r\n      before: _include.before ? Number(_include.before) : Infinity,\r\n    },\r\n    exclude: {\r\n      ..._exclude,\r\n      after: _exclude.after ? Number(_exclude.after) : Infinity,\r\n      before: _exclude.before ? Number(_exclude.before) : 0,\r\n    },\r\n  }\r\n  const { include = {}, exclude = {} } = filters\r\n  return state.guide.events.filter(event => {\r\n    \r\n    // filter within time range\r\n    if (event.start < include.after) return false\r\n    if (event.start > exclude.after) return false\r\n    if (event.end > include.before) return false\r\n    if (event.end < exclude.before) return false\r\n    \r\n    // filter by location\r\n    if ('locations' in include && !contains(include.locations, event.location)) return false\r\n    if ('locations' in exclude && contains(exclude.locations, event.location)) return false\r\n    \r\n    // filter by name\r\n    if ('search' in include && !contains(event.name, include.search)) return false\r\n    if ('search' in exclude && contains(event.name, exclude.search)) return false\r\n\r\n    // if all previous checks pass, keep this event in the array\r\n    return true\r\n  })\r\n}\r\n\r\nconst getLocations = async () => {\r\n  await state.waitForFetch()\r\n  return state.locations\r\n}\r\n\r\nconst getTimes = async () => {\r\n  await state.waitForFetch()\r\n  return state.times\r\n}\r\n\r\nconst getFloorPlan = async () => {\r\n  await state.waitForFetch()\r\n  return state.guide.floorPlan\r\n}\r\n\r\nconst addFavorite = async event => {\r\n  const favorites = await state.addFavorite(event)\r\n  return favorites\r\n}\r\n\r\nconst removeFavorite = async event => {\r\n  const favorites = await state.removeFavorite(event)\r\n  return favorites\r\n}\r\n\r\nconst getFavorites = async () => {\r\n  const favorites = await state.getFavorites()\r\n  return favorites\r\n}\r\n\r\nconst updateHiddenLocations = async newHiddenLocations => {\r\n  const hiddenLocations = await state.updateHiddenLocations(newHiddenLocations)\r\n  return hiddenLocations\r\n}\r\n\r\nconst getHiddenLocations = async () => {\r\n  const hiddenLocations = await state.getHiddenLocations()\r\n  return hiddenLocations\r\n}\r\n\r\nexport {\r\n  init,\r\n  addFavorite,\r\n  removeFavorite,\r\n  getFavorites,\r\n  updateHiddenLocations,\r\n  getHiddenLocations,\r\n  getEvents,\r\n  getLocations,\r\n  getTimes,\r\n  getFloorPlan,\r\n}\r\n","import { WholeNumber } from '../../utilities'\r\n\r\n// converts dates to actual `Date()` objects\r\nexport const getActiveEvent = event => ({\r\n  ...event,\r\n  start: new Date(event.start),\r\n  end: new Date(event.end),\r\n})\r\n\r\n\r\n// gets all data needed for one cell, so the logic doesn't clutter the template\r\nexport const getCellData = ({ events, spanState, date, interval, _location, currentTime }) => {\r\n\r\n  // find an event starting at this time\r\n  const _event = events.find(e =>\r\n    Number(e.start) === Number(date)\r\n    && e.location === _location\r\n  )\r\n\r\n  // handle events that already started before the start time\r\n  const event = !_event\r\n    ? events.find(e =>\r\n        Number(e.end) > Number(date)\r\n        && Number(e.start) < Number(currentTime)\r\n        && e.location === _location\r\n      )\r\n    : _event\r\n\r\n  const hasStarted = event ? event.start < currentTime : false\r\n  const eventName = event ? event.name : ''\r\n  const cellType = event ? 'data' : 'data-empty'\r\n  const getStart = event => hasStarted ? currentTime : event.start\r\n  const duration = event ? WholeNumber((event.end - getStart(event)) / 1000 / 60) : 0\r\n  const span = duration ? WholeNumber(duration / interval) : 1\r\n  const blank = spanState[_location] > 0\r\n\r\n  // handle spanState to prevent extra columns\r\n  if (blank) --spanState[_location]\r\n  else if (span > 1) spanState[_location] = span - 1\r\n\r\n  // return all necessary information included in the template\r\n  return { eventName, cellType, span, blank, event, hasStarted }\r\n}\r\n","import { loading, dialogPolyfill, dialog, floorPlan, icons, mobile, search, table, theme, mainMenu } from './styles'\r\n\r\n\r\nexport const getStyles = breakpoint => /* css */`\r\n\r\n/* browser defaults for dialog element */\r\n${dialogPolyfill}\r\n\r\n.pg-header {\r\n  background-color: var(--color-background);\r\n  display: grid;\r\n  grid-template-columns: 1fr auto;\r\n}\r\n\r\n.pg-maximize-button {\r\n  background-color: var(--color-header);\r\n  border: var(--rem-0-2) solid var(--color-background);\r\n  border-left-width: 0;\r\n  border-bottom-width: 0;\r\n  color: var(--color-header-content);\r\n  cursor: pointer;\r\n  margin: 0;\r\n}\r\n\r\n.pg-maximized {\r\n  display: grid;\r\n  grid-template-rows: auto 1fr;\r\n  position: fixed;\r\n  height: 100%;\r\n  width: 100%;\r\n  inset: 0;\r\n  margin: auto;\r\n  z-index: var(--max-z-index);\r\n}\r\n\r\n.pg-maximized .pg-table-wrapper,\r\n.pg-maximized .pg-floor-plan-wrapper {\r\n  height: 100%;\r\n  max-height: none;\r\n  margin-bottom: 0;\r\n}\r\n\r\n.pg-inline-text {\r\n  display: inline-block;\r\n}\r\n\r\n.pg-checkbox-wrapper {\r\n  display: block;\r\n  padding: 0.2rem 0;\r\n  font-size: 1rem;\r\n}\r\n\r\n.pg-checkbox {\r\n  font-size: 2rem;\r\n  height: 1.5rem;\r\n  width: 1.5rem;\r\n  vertical-align: middle;\r\n}\r\n\r\n.pg-checkbox-text {\r\n  vertical-align: middle;\r\n}\r\n\r\n${theme}\r\n${loading}\r\n${search}\r\n${mainMenu}\r\n${table}\r\n${icons}\r\n${dialog}\r\n${floorPlan}\r\n\r\n/* apply mobiles styles within the provided breakpoint */\r\n@media (max-width: ${breakpoint}) {\r\n  ${mobile}\r\n}\r\n`\r\n","import { DEFAULT_TIMES } from '../../../constants'\r\nimport { mapString, runMethod, parseLocationHash } from '../../../utilities'\r\n\r\nconst renderSortDialog = ({ locations, hiddenLocations, times, activeDay, activeTime: _activeTime, sortBy }, component) => {\r\n\r\n  // only show location list if the columns are collapsed\r\n  const { days, interval } = times || DEFAULT_TIMES\r\n  const getTimeValue = date => date.toLocaleTimeString([], { hour12: false, timeStyle: 'short' })\r\n  const activeTime = getTimeValue(_activeTime)\r\n  // const currentTimes = days[activeDay]\r\n  // const minTime = getTimeValue(currentTimes[0].date)\r\n  // const maxTime = getTimeValue(currentTimes[currentTimes.length - 1].date)\r\n  const step = interval * 60\r\n\r\n  // set events after rendering finishes, hence timeout\r\n  setTimeout(() => {\r\n    const allLocationsCheckbox = component.root.querySelector('.pg-checkbox--allHiddenLocations')\r\n    const toggleAllHiddenLocationCheckboxes = () => {\r\n      const locationCheckboxes = component.root.querySelectorAll('.pg-checkbox--hiddenLocation')\r\n      for (const checkbox of locationCheckboxes) {\r\n        checkbox.checked = allLocationsCheckbox.checked\r\n      }\r\n      component.toggleAllHiddenLocations()\r\n    }\r\n    allLocationsCheckbox.addEventListener('change', toggleAllHiddenLocationCheckboxes)\r\n  })\r\n\r\n  return /* html */`\r\n    <section class=\"pg-dialog-body\">\r\n      <header class=\"pg-dialog-header\">\r\n        <h1 class=\"pg-dialog-title\">Options</h1>\r\n        <button class=\"pg-dialog-close\" title=\"Close\" onclick=\"${runMethod('toggleSortDialog', false)}\"><i class=\"pg-close-icon\" title=\"Close\"></i></button>\r\n      </header>\r\n      <section class=\"pg-dialog-content\">\r\n        <menu class=\"pg-dialog-menu\">\r\n          <label class=\"pg-dialog-menu-title\">Which day?\r\n            <select class=\"pg-dialog-select\" onchange=\"${runMethod('selectActiveDay')}\">\r\n              ${mapString(Object.keys(days), day => /* html */`\r\n                <option value=\"${day}\" ${day === activeDay ? 'selected' : ''}>${day}</option>\r\n              `)}\r\n            </select>\r\n          </label>\r\n        </menu>\r\n        <menu class=\"pg-dialog-menu\">\r\n          <h2 class=\"pg-dialog-menu-title\">Schedule View</h2>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'location')}\" autofocus>Location</button>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'time')}\">Time</button>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'list')}\">List</button>\r\n        </menu>\r\n        <menu class=\"pg-dialog-menu\">\r\n          <h2 class=\"pg-dialog-menu-title\">Filter by Time</h2>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'allTime')}\">All Times This Day</button>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'now')}\">Right Now &amp; Onward</button>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'nowOnly')}\">Right Now Only</button>\r\n          <div class=\"pg-dialog-menu-special-item\">\r\n            <div class=\"pg-dialog-menu-item pg-dialog-menu-item--input\">\r\n              <input\r\n                type=\"time\"\r\n                class=\"pg-dialog-menu-input pg-dialog-menu-input--time\"\r\n                value=\"${activeTime}\"\r\n                ${/* min=\"${minTime}\"\r\n                max=\"${maxTime}\" */''}\r\n                step=\"${step}\"\r\n                onchange=\"${runMethod('selectActiveTime')}\"\r\n              />\r\n              <span class=\"pg-inline-text\">&amp; On</span>\r\n            </div>\r\n            <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'time')}\">Go &roarr;</button>\r\n          </div>\r\n        </menu>\r\n        <menu class=\"pg-dialog-menu\">\r\n          <h2 class=\"pg-dialog-menu-title\">Filter by Location</h2>\r\n          <label class=\"pg-checkbox-wrapper\">\r\n            <input class=\"pg-checkbox pg-checkbox--allHiddenLocations\" type=\"checkbox\" ${locations.some(_location => hiddenLocations.includes(_location)) ? '' : 'checked'} />\r\n            <span class=\"pg-checkbox-text\">Toggle All Locations</span>\r\n          </label>\r\n          ${mapString(locations, _location => /* html */`\r\n            <label class=\"pg-checkbox-wrapper\">\r\n              <input class=\"pg-checkbox pg-checkbox--hiddenLocation\" type=\"checkbox\" onchange=\"${runMethod('toggleHiddenLocation', _location)}\" ${hiddenLocations.includes(_location) ? '' : 'checked'} />\r\n              <span class=\"pg-checkbox-text\">${_location}</span>\r\n            </label>\r\n          `)}\r\n        </menu>\r\n        <menu class=\"pg-dialog-menu\">\r\n          <h2 class=\"pg-dialog-menu-title\">Jump to a Location</h2>\r\n          ${mapString(locations, _location => /* html */`\r\n            <a class=\"pg-dialog-menu-item\" href=\"${parseLocationHash(_location)}\">${_location}</a>\r\n          `)}\r\n        </menu>\r\n      </section>\r\n    </section>\r\n  `\r\n}\r\n\r\nexport default renderSortDialog\r\n","import { mapString, runMethod } from '../../../utilities'\r\n\r\nconst renderEventDialog = ({ favorites, activeEvent, sortBy }) => {\r\n\r\n  const existingFavorite = favorites.find(({ location: _location, start, name }) => {\r\n    const { location: aLocation, start: aStart, name: aName } = activeEvent\r\n    return _location === aLocation && Number(new Date(start)) === Number(aStart) && name === aName\r\n  })\r\n  const favoriteMethod = existingFavorite ? 'removeFavorite' : 'addFavorite'\r\n  const favoriteText = existingFavorite ? 'Remove from Favorites' : 'Add to Favorites'\r\n\r\n  return /* html */`\r\n    <article class=\"pg-dialog-body\">\r\n      <header class=\"pg-dialog-header\">\r\n        <h1 class=\"pg-dialog-title\">${activeEvent.name}</h1>\r\n        <button class=\"pg-dialog-close\" onclick=\"${runMethod('closeEventDialog')}\"><i class=\"pg-close-icon\" title=\"Close\"></i></button>\r\n      </header>\r\n      <section class=\"pg-dialog-content pg-dialog-content--text-container\">\r\n        ${mapString(activeEvent.description.split(/\\n/), paragraph => /* html */`\r\n          <p class=\"pg-dialog-paragraph\">${paragraph}</p>\r\n        `)}\r\n      </section>\r\n      <footer class=\"pg-dialog-footer\">\r\n        <time datetime=\"${activeEvent.start.toISOString()}\" class=\"pg-time pg-time--start\">\r\n          ${activeEvent.start.toLocaleTimeString('en-US', { timeStyle: 'short' })}\r\n        </time>\r\n        to\r\n        <time datetime=\"${activeEvent.end.toISOString()}\" class=\"pg-time pg-time--end\">\r\n          ${activeEvent.end.toLocaleTimeString('en-US', { timeStyle: 'short' })}\r\n        </time>\r\n        <div>@ ${activeEvent.location}</div>\r\n        <div class=\"pg-dialog-details\">\r\n          <div><strong>Hosted by:</strong> <span>${activeEvent.host}</span></div>\r\n          <div><strong>Category:</strong> <span>${activeEvent.category}</span></div>\r\n        </div>\r\n      </footer>\r\n      <section class=\"pg-dialog-content\">\r\n        <menu class=\"pg-dialog-menu\">\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod(favoriteMethod, activeEvent)}\" autofocus>\r\n            <span>${favoriteText}</span>\r\n            <i class=\"pg-favorite-icon\" title=\"${favoriteText}\">&starf;</i>\r\n          </button>\r\n          ${sortBy === 'favorites'\r\n            ? ''\r\n            : /* html */\r\n              `<button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'favorites')}\" autofocus>\r\n                <span>View All Favorites</span>\r\n                <i class=\"pg-favorite-icon\" title=\"View All Favorites\">&starf;</i>\r\n              </button>`\r\n          }\r\n        </menu>\r\n      </section>\r\n    </article>\r\n  `\r\n}\r\n\r\nexport default renderEventDialog\r\n","import { DEFAULT_TIMES } from '../../../constants'\r\nimport { getEventId, mapString, runMethod, trim } from '../../../utilities'\r\nimport { getCellData } from '../componentUtils'\r\n\r\nconst renderByLocation = ({ activeLocation, events, times: allTimes, locations, hiddenLocations, activeDay, marker }) => {\r\n\r\n  const { days, interval } = allTimes || DEFAULT_TIMES\r\n\r\n  // this keeps rowspans from previous iterations in memory\r\n  // so we can avoid adding extra table cells.\r\n  const spanState = {}\r\n\r\n  // utility to check if the given location is active and return the class accordingly\r\n  const getActiveClass = (_location, className) => activeLocation === _location ? className : ''\r\n  const getMarkerClass = (_location, className) => marker === _location ? className : ''\r\n\r\n  // get all the times in the current day\r\n  const times = days[activeDay]\r\n\r\n  // Get locations minus hiddenLocations\r\n  const availableLocations = locations.filter(locName => !hiddenLocations.includes(locName))\r\n\r\n  return /* html */`\r\n    <div class=\"pg-table-wrapper\">\r\n      <table class=\"pg-table\">\r\n        <thead class=\"pg-table-header\">\r\n          <tr class=\"pg-row\">\r\n            <td class=\"pg-cell-wrapper pg-cell-wrapper--corner pg-cell-wrapper--corner-collapsed\">\r\n              <div class=\"pg-cell pg-cell--corner\">\r\n                <span class=\"pg-corner-text\">\r\n                  <select class=\"pg-dialog-select\" onchange=\"${runMethod('selectActiveDay')}\" autofocus>\r\n                    ${mapString(Object.keys(days), day => /* html */`\r\n                      <option value=\"${day}\" ${day === activeDay ? 'selected' : ''}>${day}</option>\r\n                    `)}\r\n                  </select>\r\n                </span>\r\n              </div>\r\n            </td>\r\n            ${mapString(availableLocations, _location => /* html */`\r\n              <th\r\n                class=\"\r\n                  pg-cell-wrapper\r\n                  pg-cell-wrapper--column-header\r\n                  pg-cell-wrapper--column-header-location\r\n                  ${getActiveClass(_location, 'pg-cell-wrapper--column-header-active')}\r\n                  ${getMarkerClass(_location, 'pg-cell-wrapper--column-header-active-location')}\r\n                \"\r\n                onclick=\"${runMethod('showFloorPlan', _location)}\"\r\n              >\r\n                <div class=\"pg-cell pg-cell--column-header ${getActiveClass(_location, 'pg-cell--column-header-active')}\">\r\n                  <i class=\"pg-map-icon\"></i>\r\n                  <span class=\"pg-inline-text\">${_location}</span>\r\n                </div>\r\n              </th>\r\n            `)}\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"pg-body\">\r\n          ${mapString(times, ({ date, timeString }) => /* html */`\r\n            <tr class=\"pg-row\">\r\n              <th class=\"pg-cell-wrapper pg-cell-wrapper--row-header pg-cell-wrapper--row-header-location pg-cell-wrapper--row-header-collapsed\" onclick=\"${runMethod('toggleHeaders')}\">\r\n                <div class=\"pg-cell pg-cell--row-header pg-cell--row-header-location\">${timeString}</div>\r\n              </th>\r\n              ${mapString(availableLocations, _location => {\r\n                const { eventName, cellType, span, blank, event } = getCellData({ events, spanState, date, interval, _location })\r\n                const durationMinutes = event ? ((event.end.getTime() - event.start.getTime()) / 1000 / 60) : 0\r\n                const isSingleCell = durationMinutes === interval\r\n                const maxChar = isSingleCell ? 36 : 75\r\n                if (blank) return '' // blank if cell from previous row occupies this space\r\n                return /* html */`\r\n                  <td\r\n                    class=\"pg-cell-wrapper pg-cell-wrapper--${cellType} pg-cell-wrapper--${cellType}-location ${getActiveClass(_location, `pg-cell-wrapper--${cellType}-active`)}\"\r\n                    rowspan=\"${span}\"\r\n                    id=\"${event ? getEventId(event) : ''}\"\r\n                    data-column=\"${_location}\"\r\n                    ${event ? `onclick=\"${runMethod('openEventDialog', event)}\"` : ''}\r\n                  >\r\n                    <div class=\"pg-cell pg-cell--${cellType} ${getActiveClass(_location, `pg-cell--${cellType}-active`)}\">${trim(eventName, maxChar)}</div>\r\n                  </td>\r\n                `\r\n              })}\r\n            </tr>\r\n          `)}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport default renderByLocation\r\n","import { DEFAULT_TIMES } from '../../../constants'\r\nimport { getDateInfo, getEventId, mapString, roundMinutes, runMethod, trim } from '../../../utilities'\r\nimport { getCellData } from '../componentUtils'\r\n\r\nconst renderByTime = ({ events, times: allTimes, locations, hiddenLocations, sortBy, activeTime, activeDay }) => {\r\n\r\n  const { days, interval } = allTimes || DEFAULT_TIMES\r\n\r\n  // this keeps colspans from previous iterations in memory\r\n  // so we can avoid adding extra table cells.\r\n  const spanState = {}\r\n\r\n  // determine how to filter times\r\n  const _times = days[activeDay]\r\n  const now = roundMinutes(Date.now(), interval)\r\n  const { time: nowTime } = getDateInfo(now)\r\n  const filterMap = {\r\n    now: _times.filter(({ date }) => date >= now),\r\n    nowOnly: _times.filter(({ date }) => date === now),\r\n    time: _times.filter(({ date }) => date >= activeTime),\r\n    allTime: _times,\r\n  }\r\n  const filteredTimes = filterMap[sortBy]\r\n  const times = filteredTimes.length ? filteredTimes : [{ date: now, timeString: nowTime }]\r\n  const timeMap = {\r\n    now,\r\n    nowOnly: now,\r\n    time: activeTime,\r\n    allTime: new Date(0),\r\n  }\r\n  const currentTime = timeMap[sortBy]\r\n\r\n  // Get locations minus hiddenLocations\r\n  const availableLocations = locations.filter(_location => !hiddenLocations.includes(_location))\r\n\r\n  return /* html */`\r\n    <div class=\"pg-table-wrapper\">\r\n      <table class=\"pg-table\">\r\n        <thead class=\"pg-table-header\">\r\n          <tr class=\"pg-row\">\r\n            <td class=\"pg-cell-wrapper pg-cell-wrapper--corner pg-cell-wrapper--corner-collapsed\">\r\n              <div class=\"pg-cell pg-cell--corner\">\r\n                <span class=\"pg-corner-text\">\r\n                  <select class=\"pg-dialog-select\" onchange=\"${runMethod('selectActiveDay')}\" autofocus>\r\n                    ${mapString(Object.keys(days), day => /* html */`\r\n                      <option value=\"${day}\" ${day === activeDay ? 'selected' : ''}>${day}</option>\r\n                    `)}\r\n                  </select>\r\n                </span>\r\n              </div>\r\n            </td>\r\n            ${mapString(times, ({ date, timeString }) => /* html */`\r\n              <th class=\"pg-cell-wrapper pg-cell-wrapper--column-header pg-cell-wrapper--column-header-time ${date === now ? 'pg-cell-wrapper--column-header-active-time' : ''}\">\r\n                <div class=\"pg-cell pg-cell--column-header pg-cell--column-header-time\">\r\n                  <span>${timeString}</span>\r\n                  <div>${date === now ? '(Current Time)' : ''}</div>\r\n                </div>\r\n              </th>\r\n            `)}\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"pg-body\">\r\n          ${mapString(availableLocations, _location => /* html */`\r\n            <tr class=\"pg-row\">\r\n              <th class=\"pg-cell-wrapper pg-cell-wrapper--row-header pg-cell-wrapper--row-header-${sortBy === 'nowOnly' ? 'now' : 'time'} pg-cell-wrapper--row-header-collapsed\" onclick=\"${runMethod('toggleHeaders')}\">\r\n                <div class=\"pg-cell pg-cell--row-header pg-cell--row-header-time\" onclick=\"${runMethod('showFloorPlan', _location)}\">\r\n                  <i class=\"pg-map-icon\"></i>\r\n                  <span class=\"pg-inline-text\">${_location}</span>\r\n                </div>\r\n              </th>\r\n              ${mapString(times, ({ date }) => {\r\n                const { eventName, cellType, span, blank, event, hasStarted } = getCellData({ events, spanState, date, interval, _location, currentTime })\r\n                const durationMinutes = event ? ((event.end.getTime() - event.start.getTime()) / 1000 / 60) : 0\r\n                const isSingleCell = durationMinutes === interval\r\n                const maxChar = isSingleCell ? 36 : 64\r\n                if (blank) return '' // blank if cell from previous row occupies this space\r\n                return /* html */`\r\n                  <td\r\n                    class=\"pg-cell-wrapper pg-cell-wrapper--${cellType} pg-cell-wrapper--${cellType}-${sortBy === 'nowOnly' ? 'now' : 'time'} ${hasStarted ? 'pg-cell-wrapper--overflow' : ''}\"\r\n                    colspan=\"${span}\"\r\n                    id=\"${event ? getEventId(event) : ''}\"\r\n                    ${event ? `onclick=\"${runMethod('openEventDialog', event)}\"` : ''}\r\n                  >\r\n                    <div class=\"pg-cell pg-cell--${cellType} pg-cell--${cellType}-${sortBy === 'nowOnly' ? 'now' : 'time'}\">${trim(eventName, maxChar)}</div>\r\n                  </td>\r\n                `\r\n              })}\r\n            </tr>\r\n          `)}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport default renderByTime\r\n","import { mapString, runMethod, getDateInfo, trim, compareDates } from '../../../utilities'\r\n\r\nconst roundDateToDay = date => new Date(new Date(date).toISOString().slice(0, 10)).getTime()\r\n\r\nconst adjustFavorites = (_favorites, events) => {\r\n  const favorites = [..._favorites]\r\n  const matchEvent = cEvent => {\r\n    const allMatches = events.filter(event => event.name === cEvent.name)\r\n    if (allMatches.length === 0) {\r\n      return null\r\n    } else if (allMatches.length === 1) {\r\n      return allMatches[0]\r\n    } else {\r\n      const matchByTime = allMatches.find(event => event.start === cEvent.start)\r\n      if (matchByTime) return matchByTime\r\n      const matchByDayAndPlace = allMatches.find(event => {\r\n        const sameDay = roundDateToDay(event.start) === roundDateToDay(cEvent.start)\r\n        const sameLocation = event.location === cEvent.location\r\n        return sameDay && sameLocation\r\n      })\r\n      if (matchByDayAndPlace) return matchByDayAndPlace\r\n      const matchByDescription = allMatches.find(event => event.description === cEvent.description)\r\n      if (matchByDescription) return matchByDescription\r\n      const matchByLocation = allMatches.find(event => event.location === cEvent.location)\r\n      if (matchByLocation) return matchByLocation\r\n      return allMatches[0]\r\n    }\r\n  }\r\n  favorites.sort(compareDates)\r\n  return favorites.filter(matchEvent).map(matchEvent)\r\n}\r\n\r\nconst renderFavorites = ({ favorites: _favorites, events }) => {\r\n  const favorites = adjustFavorites(_favorites, events)\r\n  return /* html */`\r\n    <div class=\"pg-table-wrapper\">\r\n      <table class=\"pg-table\">\r\n        <thead class=\"pg-table-header\">\r\n          <tr class=\"pg-row\">\r\n            <td class=\"pg-cell-wrapper pg-cell-wrapper--corner\">\r\n              <div class=\"pg-cell pg-cell--corner\">Favorites</div>\r\n            </td>\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"pg-body\">\r\n          ${favorites.length === 0\r\n            ? /* html */`\r\n                <tr class=\"pg-row\">\r\n                  <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-favorite\">\r\n                    <div class=\"pg-cell pg-cell--data pg-cell--data-favorite\">You have no favorites.</div>\r\n                  </td>\r\n                </tr>\r\n              `\r\n            : mapString(favorites, event => {\r\n              const { start, end, name, location } = event\r\n              const startDate = getDateInfo(start)\r\n              const endDate = getDateInfo(end)\r\n              const day = `${startDate.day} ${startDate.date}`\r\n              const startTime = startDate.time\r\n              const endTime = endDate.time\r\n              return /* html */`\r\n                <tr class=\"pg-row\">\r\n                  <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-favorite\" onclick=\"${runMethod('openEventDialog', event)}\">\r\n                    <div class=\"pg-cell pg-cell--data pg-cell--data-favorite\">\r\n                      <span class=\"pg-search-result-name\">${trim(name)}</span>\r\n                      <span class=\"pg-inline-result-details\">${day}</span>\r\n                      <span class=\"pg-search-result-details\">\r\n                        <span class=\"pg-inline-text\">${startTime}</span>\r\n                        <span class=\"pg-inline-text\">- ${endTime}</span>\r\n                        <span class=\"pg-inline-text\"> @ ${location}</span>\r\n                      </span>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              `\r\n            })\r\n          }\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport default renderFavorites\r\n","import { getDateInfo, mapString, runMethod, trim } from '../../../utilities'\r\n\r\nconst renderSearchResults = ({ searchResults }) => /* html */`\r\n  <div class=\"pg-table-wrapper\">\r\n    <table class=\"pg-table\">\r\n      <thead class=\"pg-table-header\">\r\n        <tr class=\"pg-row\">\r\n          <td class=\"pg-cell-wrapper pg-cell-wrapper--search-header\">\r\n            <div class=\"pg-cell pg-cell--search-header\">Search Results</div>\r\n          </td>\r\n        </tr>\r\n      </thead>\r\n      <tbody class=\"pg-body\">\r\n        ${searchResults.length === 0\r\n          ? /* html */`\r\n              <tr class=\"pg-row\">\r\n                <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-search\">\r\n                  <div class=\"pg-cell pg-cell--data pg-cell--data-search\">No results found.</div>\r\n                </td>\r\n              </tr>\r\n            `\r\n          : mapString(searchResults, event => {\r\n            const { start, end, name, location } = event\r\n            const startDate = getDateInfo(start)\r\n            const endDate = getDateInfo(end)\r\n            const day = `${startDate.day} ${startDate.date}`\r\n            const startTime = startDate.time\r\n            const endTime = endDate.time\r\n            return /* html */`\r\n              <tr class=\"pg-row\">\r\n                <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-search\" onclick=\"${runMethod('openEventDialog', event)}\">\r\n                  <div class=\"pg-cell pg-cell--data pg-cell--data-search\">\r\n                    <span class=\"pg-search-result-name\">${trim(name)}</span>\r\n                    <span class=\"pg-inline-result-details\">${day}</span>\r\n                    <span class=\"pg-search-result-details\">\r\n                      <span class=\"pg-inline-text\">${startTime}</span>\r\n                      <span class=\"pg-inline-text\">- ${endTime}</span>\r\n                      <span class=\"pg-inline-text\"> @ ${location}</span>\r\n                    </span>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            `\r\n          })\r\n        }\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n`\r\n\r\nexport default renderSearchResults\r\n","import { mapString, runMethod, getMarkerCoords } from '../../../utilities'\r\n\r\nconst renderFloorPlan = ({ floorPlan, floorPlanInteractive, marker }) => {\r\n  const { title, clickableAreas, dimensions } = floorPlan\r\n  const { height, width } = dimensions\r\n  const showMap = clickableAreas.length > 0 && floorPlanInteractive\r\n  const markerCoords = marker !== 'none' ? getMarkerCoords(marker, clickableAreas) : []\r\n  const [x, y] = markerCoords\r\n  const zoomButtonText = floorPlanInteractive ? 'Fit to Screen' : 'Original Size'\r\n\r\n  return /* html */`\r\n    <div class=\"pg-floor-plan-wrapper\">\r\n      <header class=\"pg-floor-plan-header\">\r\n        <menu class=\"pg-floor-plan-menu\">\r\n          <div class=\"pg-floor-plan-menu-section\">\r\n            <button class=\"pg-floor-plan-interactive-button\" onclick=\"${runMethod('toggleFloorPlanInteractive', null)}\">\r\n              <i class=\"pg-search-icon\" title=\"${zoomButtonText}\"></i> ${zoomButtonText}\r\n            </button>\r\n            ${clickableAreas.length > 0\r\n              ? (floorPlanInteractive\r\n                  ? /* html */`<span class=\"pg-inline-text\">Select an area for details.</span>`\r\n                  : /* html */`<span class=\"pg-inline-text\">View original size for more actions.</span>`\r\n                )\r\n              : ''\r\n            }\r\n          </div>\r\n        </menu>\r\n        <h1 class=\"pg-floor-plan-title\">${title}</h1>\r\n      </header>\r\n      <div class=\"pg-floor-plan-container\">\r\n\r\n        ${showMap\r\n          ? /* html */`\r\n            <map name=\"floorPlan\" id=\"floorPlan\">\r\n              ${mapString(clickableAreas, ({ shape, coords, href, alt, location: _location }) => {\r\n                const fullHref = href.startsWith(':') ? `http${href}`\r\n                  : href.startsWith('//') ? `http:${href}`\r\n                  : href\r\n                const isExternalLink = fullHref.startsWith('http')\r\n                  && new URL(fullHref).hostname !== location.hostname\r\n                return /* html */`\r\n                  <area\r\n                    shape=\"${shape}\"\r\n                    coords=\"${coords.join(',')}\"\r\n                    href=\"${href}\"\r\n                    ${isExternalLink ? `\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                    ` : ''\r\n                    }\r\n                    alt=\"${alt ?? _location}\"\r\n                  />\r\n                `\r\n              })}\r\n            </map>`\r\n          : ''\r\n        }\r\n\r\n        <div\r\n          class=\"pg-floor-plan-image-wrapper ${showMap ? 'pg-floor-plan-image-wrapper--interactive' : ''}\"\r\n          onclick=\"${showMap\r\n            ? runMethod('showFloorPlanMessage', 'event', 'No link was provided for that area.')\r\n            : runMethod('toggleFloorPlanInteractive', true, 'event')}\"\r\n        >\r\n\r\n          <!-- This exists to prevent a safari OCR bug from interfering with the image map -->\r\n          <img\r\n            class=\"pg-overlay-image\"\r\n            ${showMap ? 'usemap=\"#floorPlan\"' : ''}\r\n            height=\"${height}\"\r\n            width=\"${width}\"\r\n            src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4xLWMwMDAgNzkuYjBmOGJlOTAsIDIwMjEvMTIvMTUtMjE6MjU6MTUgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCAyMy4yIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxQUE0RjNBMEE0MDkxMUVDOTAwN0ZBRjQwRjZGNkFBMiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxQUE0RjNBMUE0MDkxMUVDOTAwN0ZBRjQwRjZGNkFBMiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFBQTRGMzlFQTQwOTExRUM5MDA3RkFGNDBGNkY2QUEyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFBQTRGMzlGQTQwOTExRUM5MDA3RkFGNDBGNkY2QUEyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAAAsAAAAAAEAAQAAAgJEAQA7\"\r\n          />\r\n\r\n          <!-- This gets replaced by the image element stored in memory for optimization -->\r\n          <img class=\"pg-floor-plan-image\" height=\"${height}\" width=\"${width}\" />\r\n          ${x && y && showMap\r\n            ? /* html */`\r\n              <div class=\"pg-floor-plan-marker\" style=\"--x: ${x}px; --y: ${y}px\">\r\n                <i class=\"pg-map-icon\"></i>\r\n              </div>`\r\n            : ''\r\n          }\r\n          <div class=\"pg-floor-plan-message\" role=\"alert\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport default renderFloorPlan\r\n","import { mapString, runMethod, getDateInfo } from '../../../utilities'\r\n\r\nconst renderAsList = ({ events, hiddenLocations, activeDay, times }) => {\r\n\r\n  // Sort events in ascending order (earliest to latest)\r\n  const sortedEvents = [...events].sort(\r\n    (e1, e2) => Number(new Date(e1.start)) - Number(new Date(e2.start)),\r\n  )\r\n\r\n  // only show location list if the columns are collapsed\r\n  const { days } = times || DEFAULT_TIMES\r\n\r\n  return /* html */`\r\n    <div class=\"pg-table-wrapper\">\r\n      <table class=\"pg-table\">\r\n        <thead class=\"pg-table-header\">\r\n          <tr class=\"pg-row\">\r\n            <td class=\"pg-cell-wrapper pg-cell-wrapper--corner\">\r\n              <div class=\"pg-cell\">\r\n                <span class=\"pg-corner-text\">\r\n                  <select class=\"pg-dialog-select\" onchange=\"${runMethod('selectActiveDay')}\" autofocus>\r\n                    ${mapString(Object.keys(days), day => /* html */`\r\n                      <option value=\"${day}\" ${day === activeDay ? 'selected' : ''}>${day}</option>\r\n                    `)}\r\n                  </select>\r\n                </span>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"pg-body\">\r\n          ${mapString(sortedEvents, event => {\r\n            const { start, end, name, location } = event\r\n\r\n            // Don't render if location is filtered out\r\n            if (hiddenLocations.includes(location)) return\r\n            \r\n            // Don't render if not same date\r\n            if (new Date(activeDay).getDate() !== new Date(start).getDate()) return\r\n\r\n            const startDate = getDateInfo(start)\r\n            const endDate = getDateInfo(end)\r\n            const day = `${startDate.day} ${startDate.date}`\r\n            const startTime = startDate.time\r\n            const endTime = endDate.time\r\n            return /* html */`\r\n              <tr class=\"pg-row\">\r\n                <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-favorite\" onclick=\"${runMethod('openEventDialog', event)}\">\r\n                  <div class=\"pg-cell pg-cell--data pg-cell--data-favorite\">\r\n                    <span class=\"pg-search-result-name\">${name}</span>\r\n                    <span class=\"pg-inline-result-details\"><strong>Location:</strong> ${location}</span>\r\n                    <span class=\"pg-inline-result-details\">${day}</span>\r\n                    <span class=\"pg-search-result-details\">\r\n                      <span class=\"pg-inline-text\">${startTime}</span>\r\n                      <span class=\"pg-inline-text\">- ${endTime}</span>\r\n                    </span>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            `\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport default renderAsList\r\n","/**\r\n * This file is temporary.  It will soon be replaced by the 'dialog-polyfill' npm package by the GoogleChrome team.\r\n * There is an active pull request to merge these changes into the open source repository, but until then, we'll need\r\n * to depend on a local version.\r\n * \r\n * https://github.com/GoogleChrome/dialog-polyfill/pull/231\r\n */\r\n\r\nvar dialogPolyfill = {};\r\n\r\n// This condition assures imports don't break for isomorphic scripts,\r\n// while also preventing unexpected uses of this package on the server side.\r\nif (typeof window === 'undefined') {\r\n  function getServerSideThrower(name, isProp) {\r\n    var error = '';\r\n    if (isProp) {\r\n      error = 'Cannot access property `dialogPolyfill.' + name + '` on the server side.';\r\n    } else {\r\n      error = 'Cannot execute `dialogPolyfill.' + name + '()` on the server side.';\r\n    }\r\n    return function() {\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  dialogPolyfill.registerDialog = getServerSideThrower('registerDialog');\r\n  dialogPolyfill.forceRegisterDialog = getServerSideThrower('forceRegisterDialog');\r\n  dialogPolyfill.reposition = getServerSideThrower('reposition');\r\n  dialogPolyfill.isInlinePositionSetByStylesheet = getServerSideThrower('isInlinePositionSetByStylesheet');\r\n  dialogPolyfill.needsCentering = getServerSideThrower('needsCentering');\r\n  dialogPolyfill.DialogManager = getServerSideThrower('DialogManager');\r\n  Object.defineProperties(dialogPolyfill, {\r\n    dm: { get: getServerSideThrower('dm', true) },\r\n    formSubmitter: { get: getServerSideThrower('formSubmitter', true) },\r\n    imagemapUseValue: { get: getServerSideThrower('imagemapUseValue', true) }\r\n  });\r\n} else {\r\n\r\n  // nb. This is for IE10 and lower _only_.\r\n  var supportCustomEvent = window.CustomEvent;\r\n  if (!supportCustomEvent || typeof supportCustomEvent === 'object') {\r\n    supportCustomEvent = function CustomEvent(event, x) {\r\n      x = x || {};\r\n      var ev = document.createEvent('CustomEvent');\r\n      ev.initCustomEvent(event, !!x.bubbles, !!x.cancelable, x.detail || null);\r\n      return ev;\r\n    };\r\n    supportCustomEvent.prototype = window.Event.prototype;\r\n  }\r\n\r\n  /**\r\n   * Dispatches the passed event to both an \"on<type>\" handler as well as via the\r\n   * normal dispatch operation. Does not bubble.\r\n   *\r\n   * @param {!EventTarget} target\r\n   * @param {!Event} event\r\n   * @return {boolean}\r\n   */\r\n  function safeDispatchEvent(target, event) {\r\n    var check = 'on' + event.type.toLowerCase();\r\n    if (typeof target[check] === 'function') {\r\n      target[check](event);\r\n    }\r\n    return target.dispatchEvent(event);\r\n  }\r\n\r\n  /**\r\n   * @param {Element} el to check for stacking context\r\n   * @return {boolean} whether this el or its parents creates a stacking context\r\n   */\r\n  function createsStackingContext(el) {\r\n    while (el && el !== document.body) {\r\n      var s = window.getComputedStyle(el);\r\n      var invalid = function(k, ok) {\r\n        return !(s[k] === undefined || s[k] === ok);\r\n      };\r\n\r\n      if (s.opacity < 1 ||\r\n          invalid('zIndex', 'auto') ||\r\n          invalid('transform', 'none') ||\r\n          invalid('mixBlendMode', 'normal') ||\r\n          invalid('filter', 'none') ||\r\n          invalid('perspective', 'none') ||\r\n          s['isolation'] === 'isolate' ||\r\n          s.position === 'fixed' ||\r\n          s.webkitOverflowScrolling === 'touch') {\r\n        return true;\r\n      }\r\n      el = el.parentElement;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Finds the nearest <dialog> from the passed element.\r\n   *\r\n   * @param {Element} el to search from\r\n   * @return {HTMLDialogElement} dialog found\r\n   */\r\n  function findNearestDialog(el) {\r\n    while (el) {\r\n      if (el.localName === 'dialog') {\r\n        return /** @type {HTMLDialogElement} */ (el);\r\n      }\r\n      if (el.parentElement) {\r\n        el = el.parentElement;\r\n      } else if (el.parentNode) {\r\n        el = el.parentNode.host;\r\n      } else {\r\n        el = null;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Blur the specified element, as long as it's not the HTML body element.\r\n   * This works around an IE9/10 bug - blurring the body causes Windows to\r\n   * blur the whole application.\r\n   *\r\n   * @param {Element} el to blur\r\n   */\r\n  function safeBlur(el) {\r\n    // Find the actual focused element when the active element is inside a shadow root\r\n    while (el && el.shadowRoot && el.shadowRoot.activeElement) {\r\n      el = el.shadowRoot.activeElement;\r\n    }\r\n\r\n    if (el && el.blur && el !== document.body) {\r\n      el.blur();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {!NodeList} nodeList to search\r\n   * @param {Node} node to find\r\n   * @return {boolean} whether node is inside nodeList\r\n   */\r\n  function inNodeList(nodeList, node) {\r\n    for (var i = 0; i < nodeList.length; ++i) {\r\n      if (nodeList[i] === node) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @param {HTMLFormElement} el to check\r\n   * @return {boolean} whether this form has method=\"dialog\"\r\n   */\r\n  function isFormMethodDialog(el) {\r\n    if (!el || !el.hasAttribute('method')) {\r\n      return false;\r\n    }\r\n    return el.getAttribute('method').toLowerCase() === 'dialog';\r\n  }\r\n\r\n  /**\r\n   * @param {!DocumentFragment|!Element} hostElement\r\n   * @return {?Element}\r\n   */\r\n  function findFocusableElementWithin(hostElement) {\r\n    // Note that this is 'any focusable area'. This list is probably not exhaustive, but the\r\n    // alternative involves stepping through and trying to focus everything.\r\n    var opts = ['button', 'input', 'keygen', 'select', 'textarea'];\r\n    var query = opts.map(function(el) {\r\n      return el + ':not([disabled])';\r\n    });\r\n    // TODO(samthor): tabindex values that are not numeric are not focusable.\r\n    query.push('[tabindex]:not([disabled]):not([tabindex=\"\"])');  // tabindex != \"\", not disabled\r\n    var target = hostElement.querySelector(query.join(', '));\r\n\r\n    if (!target && 'attachShadow' in Element.prototype) {\r\n      // If we haven't found a focusable target, see if the host element contains an element\r\n      // which has a shadowRoot.\r\n      // Recursively search for the first focusable item in shadow roots.\r\n      var elems = hostElement.querySelectorAll('*');\r\n      for (var i = 0; i < elems.length; i++) {\r\n        if (elems[i].tagName && elems[i].shadowRoot) {\r\n          target = findFocusableElementWithin(elems[i].shadowRoot);\r\n          if (target) {\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return target;\r\n  }\r\n\r\n  /**\r\n   * Determines if an element is attached to the DOM.\r\n   * @param {Element} element to check\r\n   * @return {boolean} whether the element is in DOM\r\n   */\r\n  function isConnected(element) {\r\n    return element.isConnected || document.body.contains(element);\r\n  }\r\n\r\n  /**\r\n   * @param {!Event} event\r\n   * @return {?Element}\r\n   */\r\n  function findFormSubmitter(event) {\r\n    if (event.submitter) {\r\n      return event.submitter;\r\n    }\r\n\r\n    var form = event.target;\r\n    if (!(form instanceof HTMLFormElement)) {\r\n      return null;\r\n    }\r\n\r\n    var submitter = dialogPolyfill.formSubmitter;\r\n    if (!submitter) {\r\n      var target = event.target;\r\n      var root = ('getRootNode' in target && target.getRootNode() || document);\r\n      submitter = root.activeElement;\r\n    }\r\n\r\n    if (!submitter || submitter.form !== form) {\r\n      return null;\r\n    }\r\n    return submitter;\r\n  }\r\n\r\n  /**\r\n   * @param {!Event} event\r\n   */\r\n  function maybeHandleSubmit(event) {\r\n    if (event.defaultPrevented) {\r\n      return;\r\n    }\r\n    var form = /** @type {!HTMLFormElement} */ (event.target);\r\n\r\n    // We'd have a value if we clicked on an imagemap.\r\n    var value = dialogPolyfill.imagemapUseValue;\r\n    var submitter = findFormSubmitter(event);\r\n    if (value === null && submitter) {\r\n      value = submitter.value;\r\n    }\r\n\r\n    // There should always be a dialog as this handler is added specifically on them, but check just\r\n    // in case.\r\n    var dialog = findNearestDialog(form);\r\n    if (!dialog) {\r\n      return;\r\n    }\r\n\r\n    // Prefer formmethod on the button.\r\n    var formmethod = submitter && submitter.getAttribute('formmethod') || form.getAttribute('method');\r\n    if (formmethod !== 'dialog') {\r\n      return;\r\n    }\r\n    event.preventDefault();\r\n\r\n    if (value != null) {\r\n      // nb. we explicitly check against null/undefined\r\n      dialog.close(value);\r\n    } else {\r\n      dialog.close();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {!HTMLDialogElement} dialog to upgrade\r\n   * @constructor\r\n   */\r\n  function dialogPolyfillInfo(dialog) {\r\n    this.dialog_ = dialog;\r\n    this.replacedStyleTop_ = false;\r\n    this.openAsModal_ = false;\r\n\r\n    // Set a11y role. Browsers that support dialog implicitly know this already.\r\n    if (!dialog.hasAttribute('role')) {\r\n      dialog.setAttribute('role', 'dialog');\r\n    }\r\n\r\n    dialog.show = this.show.bind(this);\r\n    dialog.showModal = this.showModal.bind(this);\r\n    dialog.close = this.close.bind(this);\r\n\r\n    dialog.addEventListener('submit', maybeHandleSubmit, false);\r\n\r\n    if (!('returnValue' in dialog)) {\r\n      dialog.returnValue = '';\r\n    }\r\n\r\n    if ('MutationObserver' in window) {\r\n      var mo = new MutationObserver(this.maybeHideModal.bind(this));\r\n      mo.observe(dialog, {attributes: true, attributeFilter: ['open']});\r\n    } else {\r\n      // IE10 and below support. Note that DOMNodeRemoved etc fire _before_ removal. They also\r\n      // seem to fire even if the element was removed as part of a parent removal. Use the removed\r\n      // events to force downgrade (useful if removed/immediately added).\r\n      var removed = false;\r\n      var cb = function() {\r\n        removed ? this.downgradeModal() : this.maybeHideModal();\r\n        removed = false;\r\n      }.bind(this);\r\n      var timeout;\r\n      var delayModel = function(ev) {\r\n        if (ev.target !== dialog) { return; }  // not for a child element\r\n        var cand = 'DOMNodeRemoved';\r\n        removed |= (ev.type.substr(0, cand.length) === cand);\r\n        window.clearTimeout(timeout);\r\n        timeout = window.setTimeout(cb, 0);\r\n      };\r\n      ['DOMAttrModified', 'DOMNodeRemoved', 'DOMNodeRemovedFromDocument'].forEach(function(name) {\r\n        dialog.addEventListener(name, delayModel);\r\n      });\r\n    }\r\n    // Note that the DOM is observed inside DialogManager while any dialog\r\n    // is being displayed as a modal, to catch modal removal from the DOM.\r\n\r\n    Object.defineProperty(dialog, 'open', {\r\n      set: this.setOpen.bind(this),\r\n      get: dialog.hasAttribute.bind(dialog, 'open')\r\n    });\r\n\r\n    this.backdrop_ = document.createElement('div');\r\n    this.backdrop_.className = 'backdrop';\r\n    this.backdrop_.addEventListener('mouseup'  , this.backdropMouseEvent_.bind(this));\r\n    this.backdrop_.addEventListener('mousedown', this.backdropMouseEvent_.bind(this));\r\n    this.backdrop_.addEventListener('click'    , this.backdropMouseEvent_.bind(this));\r\n  }\r\n\r\n  dialogPolyfillInfo.prototype = /** @type {HTMLDialogElement.prototype} */ ({\r\n\r\n    get dialog() {\r\n      return this.dialog_;\r\n    },\r\n\r\n    /**\r\n     * Maybe remove this dialog from the modal top layer. This is called when\r\n     * a modal dialog may no longer be tenable, e.g., when the dialog is no\r\n     * longer open or is no longer part of the DOM.\r\n     */\r\n    maybeHideModal: function() {\r\n      if (this.dialog_.hasAttribute('open') && isConnected(this.dialog_)) { return; }\r\n      this.downgradeModal();\r\n    },\r\n\r\n    /**\r\n     * Remove this dialog from the modal top layer, leaving it as a non-modal.\r\n     */\r\n    downgradeModal: function() {\r\n      if (!this.openAsModal_) { return; }\r\n      this.openAsModal_ = false;\r\n      this.dialog_.style.zIndex = '';\r\n\r\n      // This won't match the native <dialog> exactly because if the user set top on a centered\r\n      // polyfill dialog, that top gets thrown away when the dialog is closed. Not sure it's\r\n      // possible to polyfill this perfectly.\r\n      if (this.replacedStyleTop_) {\r\n        this.dialog_.style.top = '';\r\n        this.replacedStyleTop_ = false;\r\n      }\r\n\r\n      // Clear the backdrop and remove from the manager.\r\n      this.backdrop_.parentNode && this.backdrop_.parentNode.removeChild(this.backdrop_);\r\n      dialogPolyfill.dm.removeDialog(this);\r\n    },\r\n\r\n    /**\r\n     * @param {boolean} value whether to open or close this dialog\r\n     */\r\n    setOpen: function(value) {\r\n      if (value) {\r\n        this.dialog_.hasAttribute('open') || this.dialog_.setAttribute('open', '');\r\n      } else {\r\n        this.dialog_.removeAttribute('open');\r\n        this.maybeHideModal();  // nb. redundant with MutationObserver\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Handles mouse events ('mouseup', 'mousedown', 'click') on the fake .backdrop element, redirecting them as if\r\n     * they were on the dialog itself.\r\n     *\r\n     * @param {!Event} e to redirect\r\n     */\r\n    backdropMouseEvent_: function(e) {\r\n      if (!this.dialog_.hasAttribute('tabindex')) {\r\n        // Clicking on the backdrop should move the implicit cursor, even if dialog cannot be\r\n        // focused. Create a fake thing to focus on. If the backdrop was _before_ the dialog, this\r\n        // would not be needed - clicks would move the implicit cursor there.\r\n        var fake = document.createElement('div');\r\n        this.dialog_.insertBefore(fake, this.dialog_.firstChild);\r\n        fake.tabIndex = -1;\r\n        fake.focus();\r\n        this.dialog_.removeChild(fake);\r\n      } else {\r\n        this.dialog_.focus();\r\n      }\r\n\r\n      var redirectedEvent = document.createEvent('MouseEvents');\r\n      redirectedEvent.initMouseEvent(e.type, e.bubbles, e.cancelable, window,\r\n          e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey,\r\n          e.altKey, e.shiftKey, e.metaKey, e.button, e.relatedTarget);\r\n      this.dialog_.dispatchEvent(redirectedEvent);\r\n      e.stopPropagation();\r\n    },\r\n\r\n    /**\r\n     * Focuses on the first focusable element within the dialog. This will always blur the current\r\n     * focus, even if nothing within the dialog is found.\r\n     */\r\n    focus_: function() {\r\n      // Find element with `autofocus` attribute, or fall back to the first form/tabindex control.\r\n      var target = this.dialog_.querySelector('[autofocus]:not([disabled])');\r\n      if (!target && this.dialog_.tabIndex >= 0) {\r\n        target = this.dialog_;\r\n      }\r\n      if (!target) {\r\n        target = findFocusableElementWithin(this.dialog_);\r\n      }\r\n      safeBlur(document.activeElement);\r\n      target && target.focus();\r\n    },\r\n\r\n    /**\r\n     * Sets the zIndex for the backdrop and dialog.\r\n     *\r\n     * @param {number} dialogZ\r\n     * @param {number} backdropZ\r\n     */\r\n    updateZIndex: function(dialogZ, backdropZ) {\r\n      if (dialogZ < backdropZ) {\r\n        throw new Error('dialogZ should never be < backdropZ');\r\n      }\r\n      this.dialog_.style.zIndex = dialogZ;\r\n      this.backdrop_.style.zIndex = backdropZ;\r\n    },\r\n\r\n    /**\r\n     * Shows the dialog. If the dialog is already open, this does nothing.\r\n     */\r\n    show: function() {\r\n      if (!this.dialog_.open) {\r\n        this.setOpen(true);\r\n        this.focus_();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Show this dialog modally.\r\n     */\r\n    showModal: function() {\r\n      if (this.dialog_.hasAttribute('open')) {\r\n        throw new Error('Failed to execute \\'showModal\\' on dialog: The element is already open, and therefore cannot be opened modally.');\r\n      }\r\n      if (!isConnected(this.dialog_)) {\r\n        throw new Error('Failed to execute \\'showModal\\' on dialog: The element is not in a Document.');\r\n      }\r\n      if (!dialogPolyfill.dm.pushDialog(this)) {\r\n        throw new Error('Failed to execute \\'showModal\\' on dialog: There are too many open modal dialogs.');\r\n      }\r\n\r\n      if (createsStackingContext(this.dialog_.parentElement)) {\r\n        console.warn('A dialog is being shown inside a stacking context. ' +\r\n            'This may cause it to be unusable. For more information, see this link: ' +\r\n            'https://github.com/GoogleChrome/dialog-polyfill/#stacking-context');\r\n      }\r\n\r\n      this.setOpen(true);\r\n      this.openAsModal_ = true;\r\n\r\n      // Optionally center vertically, relative to the current viewport.\r\n      if (dialogPolyfill.needsCentering(this.dialog_)) {\r\n        dialogPolyfill.reposition(this.dialog_);\r\n        this.replacedStyleTop_ = true;\r\n      } else {\r\n        this.replacedStyleTop_ = false;\r\n      }\r\n\r\n      // Insert backdrop.\r\n      this.dialog_.parentNode.insertBefore(this.backdrop_, this.dialog_.nextSibling);\r\n\r\n      // Focus on whatever inside the dialog.\r\n      this.focus_();\r\n    },\r\n\r\n    /**\r\n     * Closes this HTMLDialogElement. This is optional vs clearing the open\r\n     * attribute, however this fires a 'close' event.\r\n     *\r\n     * @param {string=} opt_returnValue to use as the returnValue\r\n     */\r\n    close: function(opt_returnValue) {\r\n      if (!this.dialog_.hasAttribute('open')) {\r\n        throw new Error('Failed to execute \\'close\\' on dialog: The element does not have an \\'open\\' attribute, and therefore cannot be closed.');\r\n      }\r\n      this.setOpen(false);\r\n\r\n      // Leave returnValue untouched in case it was set directly on the element\r\n      if (opt_returnValue !== undefined) {\r\n        this.dialog_.returnValue = opt_returnValue;\r\n      }\r\n\r\n      // Triggering \"close\" event for any attached listeners on the <dialog>.\r\n      var closeEvent = new supportCustomEvent('close', {\r\n        bubbles: false,\r\n        cancelable: false\r\n      });\r\n      safeDispatchEvent(this.dialog_, closeEvent);\r\n    }\r\n\r\n  });\r\n\r\n  dialogPolyfill.reposition = function(element) {\r\n    var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;\r\n    var topValue = scrollTop + (window.innerHeight - element.offsetHeight) / 2;\r\n    element.style.top = Math.max(scrollTop, topValue) + 'px';\r\n  };\r\n\r\n  dialogPolyfill.isInlinePositionSetByStylesheet = function(element) {\r\n    for (var i = 0; i < document.styleSheets.length; ++i) {\r\n      var styleSheet = document.styleSheets[i];\r\n      var cssRules = null;\r\n      // Some browsers throw on cssRules.\r\n      try {\r\n        cssRules = styleSheet.cssRules;\r\n      } catch (e) {}\r\n      if (!cssRules) { continue; }\r\n      for (var j = 0; j < cssRules.length; ++j) {\r\n        var rule = cssRules[j];\r\n        var selectedNodes = null;\r\n        // Ignore errors on invalid selector texts.\r\n        try {\r\n          selectedNodes = document.querySelectorAll(rule.selectorText);\r\n        } catch(e) {}\r\n        if (!selectedNodes || !inNodeList(selectedNodes, element)) {\r\n          continue;\r\n        }\r\n        var cssTop = rule.style.getPropertyValue('top');\r\n        var cssBottom = rule.style.getPropertyValue('bottom');\r\n        if ((cssTop && cssTop !== 'auto') || (cssBottom && cssBottom !== 'auto')) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  dialogPolyfill.needsCentering = function(dialog) {\r\n    var computedStyle = window.getComputedStyle(dialog);\r\n    if (computedStyle.position !== 'absolute') {\r\n      return false;\r\n    }\r\n\r\n    // We must determine whether the top/bottom specified value is non-auto.  In\r\n    // WebKit/Blink, checking computedStyle.top == 'auto' is sufficient, but\r\n    // Firefox returns the used value. So we do this crazy thing instead: check\r\n    // the inline style and then go through CSS rules.\r\n    if ((dialog.style.top !== 'auto' && dialog.style.top !== '') ||\r\n        (dialog.style.bottom !== 'auto' && dialog.style.bottom !== '')) {\r\n      return false;\r\n    }\r\n    return !dialogPolyfill.isInlinePositionSetByStylesheet(dialog);\r\n  };\r\n\r\n  /**\r\n   * @param {!Element} element to force upgrade\r\n   */\r\n  dialogPolyfill.forceRegisterDialog = function(element) {\r\n    if (window.HTMLDialogElement || element.showModal) {\r\n      console.warn('This browser already supports <dialog>, the polyfill ' +\r\n          'may not work correctly', element);\r\n    }\r\n    if (element.localName !== 'dialog') {\r\n      throw new Error('Failed to register dialog: The element is not a dialog.');\r\n    }\r\n    new dialogPolyfillInfo(/** @type {!HTMLDialogElement} */ (element));\r\n  };\r\n\r\n  /**\r\n   * @param {!Element} element to upgrade, if necessary\r\n   */\r\n  dialogPolyfill.registerDialog = function(element) {\r\n    if (!element.showModal) {\r\n      dialogPolyfill.forceRegisterDialog(element);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @constructor\r\n   */\r\n  dialogPolyfill.DialogManager = function() {\r\n    /** @type {!Array<!dialogPolyfillInfo>} */\r\n    this.pendingDialogStack = [];\r\n\r\n    var checkDOM = this.checkDOM_.bind(this);\r\n\r\n    // The overlay is used to simulate how a modal dialog blocks the document.\r\n    // The blocking dialog is positioned on top of the overlay, and the rest of\r\n    // the dialogs on the pending dialog stack are positioned below it. In the\r\n    // actual implementation, the modal dialog stacking is controlled by the\r\n    // top layer, where z-index has no effect.\r\n    this.overlay = document.createElement('div');\r\n    this.overlay.className = '_dialog_overlay';\r\n    this.overlay.addEventListener('click', function(e) {\r\n      this.forwardTab_ = undefined;\r\n      e.stopPropagation();\r\n      checkDOM([]);  // sanity-check DOM\r\n    }.bind(this));\r\n\r\n    this.handleKey_ = this.handleKey_.bind(this);\r\n    this.handleFocus_ = this.handleFocus_.bind(this);\r\n\r\n    this.zIndexLow_ = 100000;\r\n    this.zIndexHigh_ = 100000 + 150;\r\n\r\n    this.forwardTab_ = undefined;\r\n\r\n    if ('MutationObserver' in window) {\r\n      this.mo_ = new MutationObserver(function(records) {\r\n        var removed = [];\r\n        records.forEach(function(rec) {\r\n          for (var i = 0, c; c = rec.removedNodes[i]; ++i) {\r\n            if (!(c instanceof Element)) {\r\n              continue;\r\n            } else if (c.localName === 'dialog') {\r\n              removed.push(c);\r\n            }\r\n            removed = removed.concat(c.querySelectorAll('dialog'));\r\n          }\r\n        });\r\n        removed.length && checkDOM(removed);\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Called on the first modal dialog being shown. Adds the overlay and related\r\n   * handlers.\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.blockDocument = function() {\r\n    document.documentElement.addEventListener('focus', this.handleFocus_, true);\r\n    document.addEventListener('keydown', this.handleKey_);\r\n    this.mo_ && this.mo_.observe(document, {childList: true, subtree: true});\r\n  };\r\n\r\n  /**\r\n   * Called on the first modal dialog being removed, i.e., when no more modal\r\n   * dialogs are visible.\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.unblockDocument = function() {\r\n    document.documentElement.removeEventListener('focus', this.handleFocus_, true);\r\n    document.removeEventListener('keydown', this.handleKey_);\r\n    this.mo_ && this.mo_.disconnect();\r\n  };\r\n\r\n  /**\r\n   * Updates the stacking of all known dialogs.\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.updateStacking = function() {\r\n    var zIndex = this.zIndexHigh_;\r\n\r\n    for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\r\n      dpi.updateZIndex(--zIndex, --zIndex);\r\n      if (i === 0) {\r\n        this.overlay.style.zIndex = --zIndex;\r\n      }\r\n    }\r\n\r\n    // Make the overlay a sibling of the dialog itself.\r\n    var last = this.pendingDialogStack[0];\r\n    if (last) {\r\n      var p = last.dialog.parentNode || document.body;\r\n      p.appendChild(this.overlay);\r\n    } else if (this.overlay.parentNode) {\r\n      this.overlay.parentNode.removeChild(this.overlay);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @param {Element} candidate to check if contained or is the top-most modal dialog\r\n   * @return {boolean} whether candidate is contained in top dialog\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.containedByTopDialog_ = function(candidate) {\r\n    while (candidate = findNearestDialog(candidate)) {\r\n      for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\r\n        if (dpi.dialog === candidate) {\r\n          return i === 0;  // only valid if top-most\r\n        }\r\n      }\r\n      candidate = candidate.parentElement;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  dialogPolyfill.DialogManager.prototype.handleFocus_ = function(event) {\r\n    var target = event.composedPath ? event.composedPath()[0] : event.target;\r\n\r\n    if (this.containedByTopDialog_(target)) { return; }\r\n\r\n    if (document.activeElement === document.documentElement) { return; }\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    safeBlur(/** @type {Element} */ (target));\r\n\r\n    if (this.forwardTab_ === undefined) { return; }  // move focus only from a tab key\r\n\r\n    var dpi = this.pendingDialogStack[0];\r\n    var dialog = dpi.dialog;\r\n    var position = dialog.compareDocumentPosition(target);\r\n    if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n      if (this.forwardTab_) {\r\n        // forward\r\n        dpi.focus_();\r\n      } else if (target !== document.documentElement) {\r\n        // backwards if we're not already focused on <html>\r\n        document.documentElement.focus();\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  dialogPolyfill.DialogManager.prototype.handleKey_ = function(event) {\r\n    this.forwardTab_ = undefined;\r\n    if (event.keyCode === 27) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      var cancelEvent = new supportCustomEvent('cancel', {\r\n        bubbles: false,\r\n        cancelable: true\r\n      });\r\n      var dpi = this.pendingDialogStack[0];\r\n      if (dpi && safeDispatchEvent(dpi.dialog, cancelEvent)) {\r\n        dpi.dialog.close();\r\n      }\r\n    } else if (event.keyCode === 9) {\r\n      this.forwardTab_ = !event.shiftKey;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Finds and downgrades any known modal dialogs that are no longer displayed. Dialogs that are\r\n   * removed and immediately readded don't stay modal, they become normal.\r\n   *\r\n   * @param {!Array<!HTMLDialogElement>} removed that have definitely been removed\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.checkDOM_ = function(removed) {\r\n    // This operates on a clone because it may cause it to change. Each change also calls\r\n    // updateStacking, which only actually needs to happen once. But who removes many modal dialogs\r\n    // at a time?!\r\n    var clone = this.pendingDialogStack.slice();\r\n    clone.forEach(function(dpi) {\r\n      if (removed.indexOf(dpi.dialog) !== -1) {\r\n        dpi.downgradeModal();\r\n      } else {\r\n        dpi.maybeHideModal();\r\n      }\r\n    });\r\n  };\r\n\r\n  /**\r\n   * @param {!dialogPolyfillInfo} dpi\r\n   * @return {boolean} whether the dialog was allowed\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.pushDialog = function(dpi) {\r\n    var allowed = (this.zIndexHigh_ - this.zIndexLow_) / 2 - 1;\r\n    if (this.pendingDialogStack.length >= allowed) {\r\n      return false;\r\n    }\r\n    if (this.pendingDialogStack.unshift(dpi) === 1) {\r\n      this.blockDocument();\r\n    }\r\n    this.updateStacking();\r\n    return true;\r\n  };\r\n\r\n  /**\r\n   * @param {!dialogPolyfillInfo} dpi\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.removeDialog = function(dpi) {\r\n    var index = this.pendingDialogStack.indexOf(dpi);\r\n    if (index === -1) { return; }\r\n\r\n    this.pendingDialogStack.splice(index, 1);\r\n    if (this.pendingDialogStack.length === 0) {\r\n      this.unblockDocument();\r\n    }\r\n    this.updateStacking();\r\n  };\r\n\r\n  dialogPolyfill.dm = new dialogPolyfill.DialogManager();\r\n  dialogPolyfill.formSubmitter = null;\r\n  dialogPolyfill.imagemapUseValue = null;\r\n\r\n  /**\r\n   * Installs global handlers, such as click listers and native method overrides. These are needed\r\n   * even if a no dialog is registered, as they deal with <form method=\"dialog\">.\r\n   */\r\n  if (window.HTMLDialogElement === undefined) {\r\n\r\n    /**\r\n     * If HTMLFormElement translates method=\"DIALOG\" into 'get', then replace the descriptor with\r\n     * one that returns the correct value.\r\n     */\r\n    var testForm = document.createElement('form');\r\n    testForm.setAttribute('method', 'dialog');\r\n    if (testForm.method !== 'dialog') {\r\n      var methodDescriptor = Object.getOwnPropertyDescriptor(HTMLFormElement.prototype, 'method');\r\n      if (methodDescriptor) {\r\n        // nb. Some older iOS and older PhantomJS fail to return the descriptor. Don't do anything\r\n        // and don't bother to update the element.\r\n        var realGet = methodDescriptor.get;\r\n        methodDescriptor.get = function() {\r\n          if (isFormMethodDialog(this)) {\r\n            return 'dialog';\r\n          }\r\n          return realGet.call(this);\r\n        };\r\n        var realSet = methodDescriptor.set;\r\n        /** @this {HTMLElement} */\r\n        methodDescriptor.set = function(v) {\r\n          if (typeof v === 'string' && v.toLowerCase() === 'dialog') {\r\n            return this.setAttribute('method', v);\r\n          }\r\n          return realSet.call(this, v);\r\n        };\r\n        Object.defineProperty(HTMLFormElement.prototype, 'method', methodDescriptor);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Global 'click' handler, to capture the <input type=\"submit\"> or <button> element which has\r\n     * submitted a <form method=\"dialog\">. Needed as Safari and others don't report this inside\r\n     * document.activeElement.\r\n     */\r\n    document.addEventListener('click', function(ev) {\r\n      dialogPolyfill.formSubmitter = null;\r\n      dialogPolyfill.imagemapUseValue = null;\r\n      if (ev.defaultPrevented) { return; }  // e.g. a submit which prevents default submission\r\n\r\n      var target = /** @type {Element} */ (ev.target);\r\n      if ('composedPath' in ev) {\r\n        var path = ev.composedPath();\r\n        target = path.shift() || target;\r\n      }\r\n      if (!target || !isFormMethodDialog(target.form)) { return; }\r\n\r\n      var valid = (target.type === 'submit' && ['button', 'input'].indexOf(target.localName) > -1);\r\n      if (!valid) {\r\n        if (!(target.localName === 'input' && target.type === 'image')) { return; }\r\n        // this is a <input type=\"image\">, which can submit forms\r\n        dialogPolyfill.imagemapUseValue = ev.offsetX + ',' + ev.offsetY;\r\n      }\r\n\r\n      var dialog = findNearestDialog(target);\r\n      if (!dialog) { return; }\r\n\r\n      dialogPolyfill.formSubmitter = target;\r\n\r\n    }, false);\r\n\r\n    /**\r\n     * Global 'submit' handler. This handles submits of `method=\"dialog\"` which are invalid, i.e.,\r\n     * outside a dialog. They get prevented.\r\n     */\r\n    document.addEventListener('submit', function(ev) {\r\n      var form = ev.target;\r\n      var dialog = findNearestDialog(form);\r\n      if (dialog) {\r\n        return;  // ignore, handle there\r\n      }\r\n\r\n      var submitter = findFormSubmitter(ev);\r\n      var formmethod = submitter && submitter.getAttribute('formmethod') || form.getAttribute('method');\r\n      if (formmethod === 'dialog') {\r\n        ev.preventDefault();\r\n      }\r\n    });\r\n\r\n    /**\r\n     * Replace the native HTMLFormElement.submit() method, as it won't fire the\r\n     * submit event and give us a chance to respond.\r\n     */\r\n    var nativeFormSubmit = HTMLFormElement.prototype.submit;\r\n    var replacementFormSubmit = function () {\r\n      if (!isFormMethodDialog(this)) {\r\n        return nativeFormSubmit.call(this);\r\n      }\r\n      var dialog = findNearestDialog(this);\r\n      dialog && dialog.close();\r\n    };\r\n    HTMLFormElement.prototype.submit = replacementFormSubmit;\r\n  }\r\n}\r\n\r\nexport default dialogPolyfill;\r\n","import { runMethod } from '../../../utilities'\r\n\r\nconst renderMenu = () => /* html */`\r\n  <menu class=\"pg-main-menu\">\r\n    <button class=\"pg-main-menu-button\" onclick=\"${runMethod('undoStateChange')}\">\r\n      <i class=\"pg-prev-icon\"></i>\r\n      <span>Back</span>\r\n    </button>\r\n    <button class=\"pg-main-menu-button\" onclick=\"${runMethod('toggleSortDialog', true)}\">\r\n      <i class=\"pg-more-icon\"></i>\r\n      <span>Menu</span>\r\n    </button>\r\n    <button class=\"pg-main-menu-button\" onclick=\"${runMethod('showFloorPlan', 'none')}\">\r\n      <i class=\"pg-map-icon\"></i>\r\n      <span>Map</span>\r\n    </button>\r\n    <button class=\"pg-main-menu-button\" onclick=\"${runMethod('selectSortBy', 'favorites')}\">\r\n      <i class=\"pg-favorite-icon\"></i>\r\n      <span>Favorites</span>\r\n    </button>\r\n    <button class=\"pg-main-menu-button\" onclick=\"${runMethod('print')}\">\r\n      <i class=\"pg-print-icon\"></i>\r\n      <span>Print</span>\r\n    </button>\r\n  </menu>\r\n`\r\n\r\nexport default renderMenu\r\n","import { DEFAULT_BREAKPOINT } from '../../../constants'\r\nimport { getStyles } from '../getStyles'\r\nimport { default as renderSortDialog } from './renderSortDialog'\r\nimport { default as renderEventDialog } from './renderEventDialog'\r\nimport { default as renderByLocation } from './renderByLocation'\r\nimport { default as renderByTime } from './renderByTime'\r\nimport { default as renderFavorites } from './renderFavorites'\r\nimport { default as renderSearchBar } from './renderSearchBar'\r\nimport { default as renderSearchResults } from './renderSearchResults'\r\nimport { default as renderFloorPlan } from './renderFloorPlan'\r\nimport { default as renderAsList } from './renderAsList'\r\nimport dialogPolyfill from './dialog-polyfill' // will be replaced by npm package soon, see file for details\r\nimport { clearHTML, runMethod } from '../../../utilities'\r\nimport renderMenu from './renderMenu'\r\n\r\nconst getRender = ({ state, component }) => async ({ initializing } = {}) => {\r\n  const { root, dataset, templateCache } = component\r\n\r\n  // clear previously rendered content\r\n  clearHTML(root)\r\n\r\n  // get style\r\n  const { css, breakpoint } = dataset\r\n  const style = css || getStyles(breakpoint || DEFAULT_BREAKPOINT)\r\n\r\n  // render loading spinner if necessary\r\n  const loadingTemplate = document.createElement('template')\r\n  loadingTemplate.innerHTML = /* html */`\r\n    <style>${style}</style>\r\n    <div class=\"pg-loading\"></div>\r\n  `\r\n  root.appendChild(loadingTemplate.content.cloneNode(true))\r\n\r\n  if (initializing) return true // successfully loaded data\r\n\r\n  // This assures renders happen at the end of the current event loop\r\n  await new Promise(resolve => { setTimeout(() => { resolve() }) })\r\n\r\n  // determine which render method to use\r\n  const renderMap = {\r\n    location: renderByLocation,\r\n    time: renderByTime,\r\n    allTime: renderByTime,\r\n    now: renderByTime,\r\n    nowOnly: renderByTime,\r\n    favorites: renderFavorites,\r\n    search: renderSearchResults,\r\n    list: renderAsList,\r\n  }\r\n  const renderTable = renderMap[state.sortBy]\r\n  const showFloorPlan = state.view === 'floorPlan'\r\n\r\n  // rewrite the template HTML\r\n  const tableTemplate = document.createElement('template')\r\n  tableTemplate.innerHTML = /* html */`\r\n    <style>\r\n      /* typical browser defaults for dialog polyfill */\r\n      dialog + .backdrop { position: fixed; top: 0; right: 0; bottom: 0; left: 0; background: rgba(0, 0, 0, 0.1); }\r\n      ${style}\r\n    </style>\r\n    <section id=\"ProgramGuide\" class=\"${state.maximized ? 'pg-maximized' : ''}\">\r\n      <header class=\"pg-header\">\r\n        ${renderSearchBar(state)}\r\n        <button class=\"pg-maximize-button\" onclick=\"${runMethod('maximize')}\">${state.maximized ? 'Exit Full Screen' : 'Full Screen'}</button>\r\n        ${renderMenu(state)}\r\n      </header>\r\n      ${showFloorPlan\r\n        ? renderFloorPlan(state)\r\n        : renderTable(state)\r\n      }\r\n    </section>\r\n    <dialog class=\"pg-dialog pg-dialog--sort\">${renderSortDialog(state, component)}</dialog>\r\n    <dialog class=\"pg-dialog pg-dialog--event\">${renderEventDialog(state)}</dialog>\r\n  `\r\n  clearHTML(root) // clear loading spinner\r\n  root.appendChild(tableTemplate.content.cloneNode(true))\r\n\r\n  const dialogs = root.querySelectorAll('.pg-dialog')\r\n  for (const dialog of dialogs) {\r\n\r\n    // register dialogs with the polyfill\r\n    dialogPolyfill.registerDialog(dialog)\r\n\r\n    // always rerender when closing dialogs\r\n    if (!dialog.classList.contains('pg-dialog--event')) {\r\n      dialog.addEventListener('close', component.render)\r\n    }\r\n  }\r\n\r\n  if (state.view === 'guide') {\r\n\r\n    // handle scrolling within the table\r\n    const wrapper = root.querySelector('.pg-table-wrapper')\r\n    const handleScroll = () => {\r\n      const SCROLLED_CLASS = 'pg-table-wrapper--scrolled'\r\n      const needsClass = wrapper.scrollLeft > 0 && !wrapper.classList.contains(SCROLLED_CLASS)\r\n      if (needsClass) wrapper.classList.add(SCROLLED_CLASS)\r\n      if (wrapper.scrollLeft === 0) wrapper.classList.remove(SCROLLED_CLASS)\r\n    }\r\n    wrapper.addEventListener('scroll', handleScroll)\r\n  } else if (state.view === 'floorPlan') {\r\n\r\n    // replace placeholder <img> with the real one stored in memory\r\n    // (this allows the image to load prior to viewing the map, and\r\n    // prevents unnecessary reloading of the image)\r\n    const image = root.querySelector('.pg-floor-plan-image')\r\n    image.replaceWith(templateCache.floorPlanImage)\r\n\r\n    // scroll marker into view if necessary\r\n    const marker = root.querySelector('.pg-floor-plan-marker')\r\n    if (marker) marker.scrollIntoView({ block: 'end' })\r\n  }\r\n\r\n  return true // success\r\n}\r\n\r\nexport {\r\n  renderSortDialog,\r\n  renderEventDialog,\r\n  getRender,\r\n}\r\n","import { runMethod } from '../../../utilities'\r\n\r\nconst renderSearchBar = ({ currentSearch }) => /* html */`\r\n  <form class=\"pg-search-bar\" onsubmit=\"${runMethod('search')}\">\r\n    <input class=\"pg-search-input\" onchange=\"${runMethod('changeSearch')}\" placeholder=\"Search events ...\" value=\"${currentSearch}\" />\r\n    <button class=\"pg-search-button\"><i class=\"pg-search-icon\" title=\"Search\"></i></button>\r\n  </form>\r\n`\r\n\r\nexport default renderSearchBar\r\n","import { addFavorite } from '../../../thunderEvents'\r\n\r\nexport default ({ state, setState, component }) => async encodedEvent => {\r\n  const { openEventDialog } = component\r\n  const eventJSON = decodeURIComponent(encodedEvent)\r\n  const event = JSON.parse(eventJSON)\r\n  await setState({\r\n    favorites: [...state.favorites, event],\r\n  }, {\r\n    render: false,\r\n    pushState: false,\r\n  })\r\n  openEventDialog(encodedEvent) // update the event modal\r\n  return await addFavorite(event)\r\n}\r\n","import { removeFavorite } from '../../../thunderEvents'\r\n\r\nexport default ({ state, setState, component }) => async encodedEvent => {\r\n  const { openEventDialog } = component\r\n  const eventJSON = decodeURIComponent(encodedEvent)\r\n  const event = JSON.parse(eventJSON)\r\n  const removeIndex = state.favorites.findIndex(({ location: _location, start, name }) => {\r\n    const { location: cLocation, start: cStart, name: cName } = event\r\n    return _location === cLocation && start === cStart && name === cName\r\n  })\r\n  const favorites = [...state.favorites]\r\n  favorites.splice(removeIndex, 1)\r\n  if (state.sortBy === 'favorites') {\r\n    await setState({ favorites }, { pushState: false })\r\n  } else {\r\n    await setState({ favorites }, { render: false, pushState: false })\r\n    openEventDialog(encodedEvent) // update the event modal\r\n  }\r\n  return await removeFavorite(event)\r\n}\r\n","import { updateHiddenLocations } from '../../../thunderEvents'\r\n\r\nexport default ({ state, setState }) => async (_location, override) => {\r\n\r\n  // If location already exists in array, remove it.\r\n  // If not, add it in.\r\n  const show = typeof override === 'boolean' ? override : state.hiddenLocations.includes(_location)\r\n\r\n  const removeIndex = state.hiddenLocations.findIndex(l => _location === l)\r\n  const hiddenLocations = [...state.hiddenLocations]\r\n  if (show && removeIndex !== -1) hiddenLocations.splice(removeIndex, 1)\r\n  else hiddenLocations.push(_location)\r\n  const newHiddenLocations = [...new Set(hiddenLocations)]\r\n\r\n  if (JSON.stringify(state.hiddenLocations) === JSON.stringify(newHiddenLocations)) return\r\n  await setState({\r\n    hiddenLocations: newHiddenLocations,\r\n  }, {\r\n    render: false,\r\n  })\r\n  return await updateHiddenLocations(newHiddenLocations)\r\n}\r\n","import { updateHiddenLocations } from '../../../thunderEvents'\r\n\r\nexport default ({ setState, state }) => async () => {\r\n\r\n  // toggle all on or off depending on whether the list is populated or not\r\n  const show = state.hiddenLocations.length > 0\r\n  await setState({\r\n    hiddenLocations: show ? [] : [...state.locations],\r\n  }, {\r\n    render: false,\r\n  })\r\n  await updateHiddenLocations()\r\n}\r\n","export default ({ component }) => event => {\r\n  const { toggleSortDialog, closeEventDialog } = component\r\n  if (event.key === 'Esc' || event.key === 'Escape') {\r\n    event.preventDefault()\r\n    toggleSortDialog(false)\r\n    closeEventDialog()\r\n  }\r\n}\r\n","export default ({ setState, state, component }) => async () => {\r\n  const { root } = component\r\n  const { locations } = state\r\n\r\n  // a little extra insurance to avoid conflicts with other code...\r\n  const hash = location.hash.replace('#', '')\r\n  if (!hash.startsWith('View-Location-')) return\r\n\r\n  // navigate to location view\r\n  const _location = locations.find(l => {\r\n    const lookup = hash.replace('View-Location-', '')\r\n    const parsed = l.replace(/[^a-zA-Z0-9]+/g, '-').replace(/^-|-$/g, '')\r\n    return lookup === parsed\r\n  })\r\n\r\n  // avoid bugs caused by undefined location\r\n  if (!_location) {\r\n    await setState({\r\n      view: 'guide',\r\n      sortBy: 'location',\r\n    }, {\r\n      pushState: false,\r\n    })\r\n    return\r\n  }\r\n\r\n  // make sure the location is not hidden\r\n  if (state.hiddenLocations.includes(_location)) {\r\n    component.toggleHiddenLocation(_location, true)\r\n  }\r\n\r\n  // render the location view with active location highlighted\r\n  await setState({\r\n    activeLocation: _location,\r\n    marker: _location,\r\n    view: 'guide',\r\n    sortBy: 'location',\r\n  }, {\r\n    pushState: false,\r\n  })\r\n\r\n  // scroll location into view if necessary\r\n  const activeLocationEl = root.querySelector('.pg-cell-wrapper--column-header-active-location')\r\n  if (activeLocationEl) {\r\n    activeLocationEl.scrollIntoView()\r\n    component.scrollIntoView()\r\n  }\r\n\r\n  // reset the hash so the navigation can be used more than once in a row\r\n  history.replaceState({}, '', location.href.replace(/#.+/, ''))\r\n}\r\n","export default ({ state, setState, component }) => async locationName => {\r\n  const { hasFloorPlan } = state\r\n  if (!hasFloorPlan) return\r\n  const { toggleFloorPlanInteractive } = component\r\n  if (state.marker === locationName && state.view === 'floorPlan') return\r\n  await setState({\r\n    marker: locationName,\r\n    view: 'floorPlan',\r\n  })\r\n  toggleFloorPlanInteractive(locationName !== 'none')\r\n}\r\n","export default ({ state, setState, component }) => async (_bool, event) => {\r\n  const { templateCache } = component\r\n  const bool = _bool ?? !state.floorPlanInteractive\r\n  const floorPlanInteractive = bool\r\n  const { floorPlanImage } = templateCache\r\n  const INTERACTIVE_CLASS = 'pg-floor-plan-image--interactive'\r\n  const addOrRemove = floorPlanInteractive ? 'add' : 'remove'\r\n  floorPlanImage.classList[addOrRemove](INTERACTIVE_CLASS)\r\n  await setState({ floorPlanInteractive }, { pushState: false })\r\n  setTimeout(() => { // wait for render\r\n    if (event) component.showFloorPlanMessage(event, 'Tap a location to view its schedule!')\r\n  })\r\n}\r\n","export default ({ state, component }) => ({ target }) => {\r\n  const { root } = component\r\n\r\n  // do nothing if viewing by \"now only\", because there's nothing to collapse\r\n  if (state.sortBy === 'nowOnly') return\r\n\r\n  // do nothing if the table hasn't scrolled\r\n  const wrapper = root.querySelector('.pg-table-wrapper')\r\n  if (!wrapper.classList.contains('pg-table-wrapper--scrolled')) return\r\n\r\n  // toggle the collapsed classes\r\n  const allHeaders = root.querySelectorAll('.pg-cell-wrapper--row-header')\r\n  const COLLAPSED_CLASS = 'pg-cell-wrapper--row-header-collapsed'\r\n  const addOrRemove = target.classList.contains(COLLAPSED_CLASS) ? 'remove' : 'add'\r\n  for (const header of allHeaders) header.classList[addOrRemove](COLLAPSED_CLASS)\r\n\r\n  // also collapse the corner\r\n  const corner = root.querySelector('.pg-cell-wrapper--corner')\r\n  corner.classList[addOrRemove]('pg-cell-wrapper--corner-collapsed')\r\n}\r\n","import { clearHTML, parseHTML } from '../../../utilities'\r\nimport { renderSortDialog } from '../render'\r\n\r\nexport default ({ state, component }) => _bool => {\r\n  const { root } = component\r\n  const bool = _bool === 'true' ? true : !!_bool\r\n  const dialog = root.querySelector('.pg-dialog--sort')\r\n  const dialogContent = parseHTML(renderSortDialog(state, component))\r\n  clearHTML(dialog)\r\n  dialog.appendChild(dialogContent)\r\n  if (bool) dialog.showModal()\r\n  else if (dialog.open) dialog.close()\r\n}\r\n","import { clearHTML, parseHTML } from '../../../utilities'\r\nimport { getActiveEvent } from '../componentUtils'\r\nimport { renderEventDialog } from '../render'\r\n\r\nexport default ({ setState, component }) => async encodedEvent => {\r\n  const { root } = component\r\n\r\n  // set event data\r\n  const eventJSON = decodeURIComponent(encodedEvent)\r\n  const event = JSON.parse(eventJSON)\r\n  const newState = await setState({ activeEvent: getActiveEvent(event) }, { render: false, pushState: false })\r\n\r\n  // show the dialog\r\n  const dialog = root.querySelector('.pg-dialog--event')\r\n  const dialogContent = parseHTML(renderEventDialog(newState))\r\n  clearHTML(dialog)\r\n  dialog.appendChild(dialogContent)\r\n  if (!dialog.open) dialog.showModal()\r\n}\r\n","export default ({ component }) => () => {\r\n  const { root } = component\r\n  const dialog = root.querySelector('.pg-dialog--event')\r\n  dialog.close()\r\n}\r\n","export default ({ setState, component }) => async _location => {\r\n  const { toggleSortDialog } = component\r\n  toggleSortDialog(false) // close upon selection\r\n  if (state.sortBy === 'location' && state.view === 'guide') return\r\n  await setState({\r\n    view: 'guide',\r\n    sortBy: 'location',\r\n    activeLocation: _location,\r\n  })\r\n}\r\n","export default ({ state, setState }) => async event => {\r\n  const activeDay = event.target.value\r\n  const timeString = state.activeTime.toLocaleTimeString()\r\n  const activeTime = new Date(`${activeDay} ${timeString}`)\r\n  if (state.activeDate === activeDay && state.activeTime === activeTime) return\r\n  await setState({\r\n    sortBy: ['time', 'allTime', 'now', 'nowOnly'].some(s => s === state.sortBy) ? 'time' : state.sortBy,\r\n    activeDay,\r\n\r\n    // also reset the active time to match the selected day\r\n    activeTime,\r\n  })\r\n}\r\n","import { DEFAULT_TIMES } from '../../../constants'\r\n\r\nexport default ({ state, setState }) => async ({ target }) => {\r\n\r\n  // validate the time and autocorrect\r\n  // if (target.min > target.value) target.value = target.min\r\n  // if (target.max < target.value) target.value = target.max\r\n  const { interval } = state.times || DEFAULT_TIMES\r\n  const [hr, mn] = target.value.split(':')\r\n  const roundedMn = Math.round(mn / interval) * interval\r\n  const newMn = String(roundedMn).length === 1 ? `0${roundedMn}` : roundedMn\r\n  target.value = `${hr}:${newMn}`\r\n\r\n  // set the time\r\n  const { activeDay } = state\r\n  const timeString = target.value\r\n  const activeTime = new Date(`${activeDay} ${timeString}`)\r\n  if (state.activeTime.toISOString() === activeTime.toISOString()) return\r\n  await setState({\r\n    activeTime,\r\n  }, {\r\n    render: false,\r\n  })\r\n}\r\n","import { getToday } from '../../../utilities'\r\n\r\nexport default ({ state, setState, component }) => async sortBy => {\r\n  const { toggleSortDialog } = component\r\n\r\n  // close upon selection\r\n  toggleSortDialog(false)\r\n  if (state.sortBy === sortBy && state.view === 'guide') return\r\n  const currentDay = sortBy === 'now' || sortBy === 'nowOnly' ? getToday(state) : state.activeDay\r\n  await setState({\r\n    view: 'guide',\r\n    marker: 'none',\r\n    sortBy,\r\n    activeDay: currentDay,\r\n  })\r\n}\r\n","export default ({ setState }) => async ({ target }) => {\r\n  await setState({ currentSearch: target.value }, { render: false, pushState: false })\r\n}\r\n","import { search } from '../../../utilities'\r\n\r\nexport default ({ state, setState }) => async event => {\r\n  event.preventDefault()\r\n  const { currentSearch, events } = state\r\n\r\n  // filter search results\r\n  const searchResults = events.filter(event => {\r\n    return (\r\n      search(currentSearch, event.name)\r\n      || search(currentSearch, event.location)\r\n      || search(currentSearch, event.host)\r\n      || search(currentSearch, event.category)\r\n      || search(currentSearch, event.description)\r\n    )\r\n  }).sort((prev, next) => {\r\n\r\n    // sort name matches at the top\r\n    const prevName = search(currentSearch, prev.name)\r\n    const nextName = search(currentSearch, next.name)\r\n    return !prevName && nextName ? 1 : (prevName && !nextName ? -1 : 0)\r\n  })\r\n\r\n  await setState({\r\n    searchResults,\r\n    sortBy: 'search',\r\n  })\r\n}\r\n","export default ({ state, component }) => (event, message) => {\r\n  const { floorPlanInteractive } = state\r\n  if (!floorPlanInteractive) return // skip if floor plan is not in original size mode\r\n  const { root } = component\r\n  const { clientY } = event\r\n  const messageEl = root.querySelector('.pg-floor-plan-message')\r\n  const ACTIVE_CLASS = 'pg-floor-plan-message--active'\r\n  messageEl.style.top = `${clientY}px`\r\n  messageEl.classList.add(ACTIVE_CLASS)\r\n  messageEl.textContent = message\r\n\r\n  // show message for 3 seconds\r\n  setTimeout(() => {\r\n    messageEl.classList.remove(ACTIVE_CLASS)\r\n    setTimeout(() => { messageEl.textContent = '' }, 600) // allow animation to finish first\r\n  }, 3000)\r\n}\r\n","export default ({ state, setState, component }) => async () => {\r\n  const { root } = component\r\n  let currentElement = root.host\r\n  while (currentElement.parentElement) {\r\n    currentElement.parentElement.style.overflow = !state.maximized\r\n      ? 'hidden' : ''\r\n    currentElement = currentElement.parentElement\r\n  }\r\n\r\n  await setState({ maximized: !state.maximized }, { pushState: false })\r\n}\r\n","export default ({ state, setState }) => async () => {\r\n  const { prevState } = state\r\n  if (prevState.length === 0) return\r\n  await setState({\r\n    ...prevState.slice(-1)[0],\r\n    maximized: state.maximized,\r\n    prevState: prevState.slice(0, -1),\r\n  }, { pushState: false })\r\n}\r\n","import { clearHTML } from '../../../utilities'\r\n\r\nconst cloneTable = (table, cols) => {\r\n  const thead = table.querySelector('thead')\r\n\tconst tbody = table.querySelector('tbody')\r\n  const clone = table.cloneNode(true)\r\n  const cloneHeadRow = clone.querySelector('thead > tr')\r\n  const cloneBodyRows = clone.querySelectorAll('tbody > tr')\r\n  const allHeaders = thead.querySelectorAll('th')\r\n  const allColumns = [...allHeaders].map(e => e.textContent.trim())\r\n  const allRows = tbody.querySelectorAll('tr')\r\n  \r\n  // clone table head\r\n  const { firstElementChild } = cloneHeadRow\r\n  clearHTML(cloneHeadRow)\r\n  cloneHeadRow.appendChild(firstElementChild)\r\n  for (const idx in allHeaders) {\r\n    const th = allHeaders[idx]\r\n  \tif (+idx < cols) cloneHeadRow.appendChild(th)\r\n  }\r\n\r\n  // clone table body\r\n  for (const idx in [...allRows]) {\r\n    const tr = allRows[idx]\r\n    const cloneTr = cloneBodyRows[idx]\r\n    const th = tr.querySelector('th')\r\n    const allCells = tr.querySelectorAll('td')\r\n  \tclearHTML(cloneTr)\r\n    cloneTr.appendChild(th.cloneNode(true))\r\n    for (const cellIdx in [...allCells]) {\r\n      const cell = allCells[cellIdx]\r\n      const colIdx = allColumns.findIndex(c => c === cell.dataset.column)\r\n      if (colIdx < cols) cloneTr.appendChild(cell)\r\n    }\r\n  }\r\n  return clone\r\n}\r\n\r\nconst divideIntoChunks = (table, cols, chunks = []) => {\r\n  const container = table.parentElement\r\n  const thead = table.querySelector('thead')\r\n  const { length } = thead.querySelectorAll('th')\r\n  if (length > cols) {\r\n    const clone = cloneTable(table, cols)\r\n    container.insertBefore(clone, table)\r\n    return divideIntoChunks(table, cols, [clone, ...chunks])\r\n  }\r\n  return [table, ...chunks]\r\n}\r\n\r\nexport default ({ setState, component }) => async () => {\r\n  await setState({\r\n    view: 'guide',\r\n    sortBy: 'location',\r\n  })\r\n  const element = component.root.querySelector('.pg-table')\r\n  const cloned = element.cloneNode(true)\r\n  const style = document.createElement('style')\r\n  style.textContent = /* css */`\r\n    @media print {\r\n      body {\r\n        print-color-adjust: exact;\r\n        -webkit-print-color-adjust: exact\r\n      }\r\n      body *:not(.printable, .printable *) {\r\n        display: none;\r\n      }\r\n      body * {\r\n        all: revert;\r\n        font-size: 1vmin;\r\n        text-align: center;\r\n      }\r\n      .pg-table {\r\n        border: 0.1rem solid;\r\n        border-collapse: collapse;\r\n        page-break-inside: avoid;\r\n        table-layout: fixed;\r\n        width: 100%;\r\n      }\r\n      .pg-table * {\r\n        padding: 0.2rem;\r\n      }\r\n      .pg-row:nth-child(odd) {\r\n        background-color: #eee;\r\n      }\r\n      .pg-row:nth-child(even) {\r\n        background-color: #ddd;\r\n      }\r\n      .pg-cell-wrapper--data {\r\n        background-color: #fff;\r\n        border: 0.1rem solid;\r\n      }\r\n      .pg-cell-wrapper--corner,\r\n      .pg-cell-wrapper--column-header,\r\n      .pg-cell-wrapper--row-header {\r\n        background-color: #555;\r\n        color: #fff;\r\n      }\r\n      @page {\r\n        size: A3 landscape;\r\n        margin: 0.05in;\r\n      }\r\n    }\r\n  `\r\n  const printState = {\r\n    chunks: [],\r\n  }\r\n  const beforePrint = () => {\r\n    document.body.appendChild(style)\r\n    document.body.appendChild(cloned)\r\n    cloned.classList.add('printable')\r\n    printState.chunks = divideIntoChunks(cloned, 16)\r\n  }\r\n  const afterPrint = () => {\r\n    document.body.removeChild(style)\r\n    for (const chunk of printState.chunks) {\r\n      document.body.removeChild(chunk)\r\n    }\r\n    window.removeEventListener('beforeprint', beforePrint)\r\n    window.removeEventListener('afterPrint', afterPrint)\r\n  }\r\n  window.addEventListener('beforeprint', beforePrint)\r\n  window.addEventListener('afterprint', afterPrint)\r\n  window.print()\r\n}\r\n","// fallback in case of Node\r\nexport default typeof HTMLElement === 'undefined' ? class {} : HTMLElement\r\n","import * as ThunderEvents from '../lib/thunderEvents'\r\nimport * as Components from '../lib/uiComponents'\r\n\r\nexport const Exports = {\r\n  ...ThunderEvents,\r\n  Components,\r\n}\r\n","import { getLocations, getEvents, getTimes, getFavorites, getHiddenLocations, getFloorPlan } from '../../thunderEvents'\r\nimport { getDateInfo, compareDates, getToday } from '../../utilities'\r\nimport { DEFAULT_EVENT, DEFAULT_TIMES } from '../../constants'\r\nimport { getActiveEvent } from './componentUtils'\r\nimport { getRender } from './render'\r\nimport {\r\n  getAddFavorite,\r\n  getHandleEsc,\r\n  getHandleHashChange,\r\n  getRemoveFavorite,\r\n  getToggleHiddenLocation,\r\n  getToggleAllHiddenLocations,\r\n  getShowFloorPlan,\r\n  getOpenEventDialog,\r\n  getToggleFloorPlanInteractive,\r\n  getToggleSortDialog,\r\n  getCloseEventDialog,\r\n  getSelectActiveLocation,\r\n  getSelectActiveDay,\r\n  getSelectActiveTime,\r\n  getSelectSortBy,\r\n  getChangeSearch,\r\n  getSearch,\r\n  getToggleHeaders,\r\n  getShowFloorPlanMessage,\r\n  getMaximize,\r\n  getUndoStateChange,\r\n  getPrint,\r\n} from './actions'\r\nimport HTMLElement from '../HTMLElement'\r\n\r\n// A native web component for the main event schedule\r\nclass ProgramGuideNative extends HTMLElement {\r\n\r\n  // the initial state is never reflected in the UI;\r\n  // a loading spinner is rendered instead.\r\n  #state = {\r\n    prevState: [],\r\n    locations: [],\r\n    events: [],\r\n    times: DEFAULT_TIMES,\r\n    activeDay: '',\r\n    activeTime: new Date(),\r\n    activeLocation: '',\r\n    activeEvent: getActiveEvent(DEFAULT_EVENT),\r\n    sortBy: 'location', // location | allTime | now | nowOnly | time | favorites | list\r\n    view: 'guide', // guide | floorPlan\r\n    marker: 'none', // one of the provided location names or 'none'\r\n    favorites: [],\r\n    hiddenLocations: [],\r\n    currentSearch: '',\r\n    searchResults: [],\r\n    hasFloorPlan: false,\r\n    floorPlan: {},\r\n    floorPlanInteractive: false,\r\n    maximized: false,\r\n  }\r\n\r\n  // cache to avoid unnecessary reloading\r\n  templateCache = {\r\n    floorPlanImage: Image ? new Image() : null,\r\n  }\r\n\r\n  constructor() {\r\n    super()\r\n\r\n    // avoid any client-side concerns in Node\r\n    if (typeof window === 'undefined') return\r\n\r\n    const component = this\r\n    component.root = component.attachShadow({ mode: 'open' })\r\n\r\n    // assign action methods from other files\r\n    const actionMap = {\r\n      render: getRender,\r\n      handleEsc: getHandleEsc,\r\n      handleHashChange: getHandleHashChange,\r\n      addFavorite: getAddFavorite,\r\n      removeFavorite: getRemoveFavorite,\r\n      toggleHiddenLocation: getToggleHiddenLocation,\r\n      toggleAllHiddenLocations: getToggleAllHiddenLocations,\r\n      showFloorPlan: getShowFloorPlan,\r\n      toggleFloorPlanInteractive: getToggleFloorPlanInteractive,\r\n      toggleHeaders: getToggleHeaders,\r\n      toggleSortDialog: getToggleSortDialog,\r\n      openEventDialog: getOpenEventDialog,\r\n      closeEventDialog: getCloseEventDialog,\r\n      selectActiveLocation: getSelectActiveLocation,\r\n      selectActiveDay: getSelectActiveDay,\r\n      selectActiveTime: getSelectActiveTime,\r\n      selectSortBy: getSelectSortBy,\r\n      changeSearch: getChangeSearch,\r\n      search: getSearch,\r\n      showFloorPlanMessage: getShowFloorPlanMessage,\r\n      maximize: getMaximize,\r\n      undoStateChange: getUndoStateChange,\r\n      print: getPrint,\r\n    }\r\n    for (const actionName in actionMap) {\r\n      const action = actionMap[actionName]\r\n      component[actionName] = component.provideState(action)\r\n    }\r\n\r\n    // render loading spinner\r\n    component.render({ initializing: true })\r\n\r\n    // asynchronously fetch data and update internal state\r\n    component.waitForFetch = getLocations().then(async locations => {\r\n\r\n      // the initial results of the async data fetcher\r\n      const programGuideData = {\r\n        events: await getEvents(),\r\n        times: await getTimes(),\r\n        favorites: await getFavorites(),\r\n        hiddenLocations: await getHiddenLocations(),\r\n        floorPlan: await getFloorPlan(),\r\n        locations: locations,\r\n      }\r\n\r\n      // load floor plan image and store it in the cache\r\n      const { floorPlanImage } = component.templateCache\r\n      const { imageSrc, dimensions } = programGuideData.floorPlan\r\n      const { height, width } = dimensions\r\n      floorPlanImage.className = 'pg-floor-plan-image'\r\n      floorPlanImage.src = imageSrc\r\n      floorPlanImage.height = height\r\n      floorPlanImage.width = width\r\n\r\n      // derive the active date and time from the earliest date in the data\r\n      const { days } = programGuideData.times || DEFAULT_TIMES\r\n      const activeDay = getToday(programGuideData)\r\n      const firstTime = days[activeDay][0].date\r\n      const { date, time } = getDateInfo(firstTime)\r\n\r\n      // update the data and replace the loading spinner with the real element\r\n      component.setState({\r\n        ...programGuideData,\r\n        activeLocation: locations[0],\r\n        activeDay,\r\n        activeTime: new Date(`${date} ${time}`),\r\n        hasFloorPlan: !!imageSrc,\r\n      }, {\r\n        pushState: false,\r\n      })\r\n    })\r\n  }\r\n\r\n  connectedCallback() {\r\n    const component = this\r\n    window.addEventListener('keydown', component.handleEsc)\r\n    component.waitForFetch.then(() => {\r\n      window.addEventListener('hashchange', component.handleHashChange)\r\n    })\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const component = this\r\n    window.removeEventListener('keydown', component.handleEsc)\r\n    window.removeEventListener('hashchange', component.handleHashChange)\r\n  }\r\n\r\n  async setState(state, options = {}) {\r\n    const _options = {\r\n      render: true,\r\n      pushState: true,\r\n      ...options,\r\n    }\r\n    const component = this\r\n    const prevState = { ...component.#state }\r\n    component.#state = {\r\n      ...prevState,\r\n      ...state,\r\n      ...(_options.pushState ? { prevState: [\r\n        ...component.#state.prevState,\r\n        prevState,\r\n      ] } : {}),\r\n    }\r\n    if (_options.render) await component.render()\r\n    return { ...component.#state }\r\n  }\r\n\r\n  provideState(getCallback) {\r\n    const component = this\r\n    return (...args) => {\r\n      const state = { ...component.#state }\r\n      const setState = component.setState.bind(component)\r\n      const callback = getCallback({ state, setState, component })\r\n      return callback(...args)\r\n    }\r\n  }\r\n}\r\n\r\nexport default ProgramGuideNative\r\n"],"names":["DEFAULT_FLOOR_PLAN","title","imageSrc","dimensions","height","width","clickableAreas","DEFAULT_GUIDE","locations","events","floorPlan","rollOverTime","DEFAULT_ADD_FAVORITE","async","favoriteEvents","JSON","parse","localStorage","getItem","push","event","eventsJSON","stringify","setItem","DEFAULT_GET_FAVORITES","DEFAULT_UPDATE_HIDDEN_LOCATIONS","hiddenLocations","console","log","DEFAULT_GET_HIDDEN_LOCATIONS","DEFAULT_FETCH_DATA","Promise","resolve","guide","addFavorite","getFavorites","updateHiddenLocations","getHiddenLocations","NOW","Date","now","DEFAULT_EVENT","start","end","location","name","host","category","description","DEFAULT_CLICKABLE_AREA","shape","coords","href","alt","DEFAULT_TIMES","days","interval","NOOP","getType","val","constructor","toLowerCase","checkType","type","validString","validArray","every","t","some","isObject","obj","useFallback","fallbackObj","onFallback","_altTypes","key","fallbackValue","valid","value","empty","altTypes","altTypesArr","mismatch","useCast","getValue","status","warn","Object","keys","reduce","castObj","checkFilterType","filter","after","before","search","clearHTML","element","i","childNodes","length","removeChild","lastChild","parseHTML","htmlStr","range","document","createRange","selectNode","body","createContextualFragment","mapString","arr","callback","map","join","roundMinutes","_date","nearestMinute","date","roundedMinutes","Math","round","getMinutes","setMinutes","WholeNumber","num","Number","toFixed","getDay","idx","short","getDateInfo","time","toLocaleTimeString","timeStyle","day","toLocaleDateString","runMethod","args","object","encodeURIComponent","string","default","String","getEventId","_start","snip","s","replace","_input","_text","formatForSimilarMatch","str","normalize","input","text","split","trim","max","slice","getLastTimeInThreshold","currentDate","allDates","threshold","lastInCurrentDay","getDate","nextDate","setDate","setTime","getTime","allTimesNextDay","lastInThreshold","compareDates","prevDate","prevTime","nextTime","getToday","state","times","nowDay","nowDate","dayKeys","find","dayKey","beforeDates","afterDates","sort","getBeforeOrAfter","_hasFetched","hasFetched","this","bool","fetchQueue","forEach","waitForFetch","removeFavorite","removeIndex","findIndex","_location","cLocation","cStart","cName","splice","has","add","Set","allTimes","prev","next","earliestTime","min","latestTime","minutes","getTimeObject","timeString","getFullDay","currentDay","lastTimeInDay","currentTime","intervalInMs","getEvents","_filters","include","_include","exclude","_exclude","filters","Infinity","contains","getLocations","getTimes","getFloorPlan","newHiddenLocations","init","data","castEvent","castFloorPlan","castClickableArea","loc","test","getActiveEvent","getCellData","spanState","_event","e","hasStarted","eventName","cellType","duration","getStart","span","blank","renderSortDialog","activeDay","activeTime","_activeTime","sortBy","component","hour12","step","setTimeout","allLocationsCheckbox","root","querySelector","addEventListener","locationCheckboxes","querySelectorAll","checkbox","checked","toggleAllHiddenLocations","includes","parseLocationHash","renderEventDialog","favorites","activeEvent","existingFavorite","aLocation","aStart","aName","favoriteMethod","favoriteText","paragraph","toISOString","renderByLocation","activeLocation","marker","getActiveClass","className","availableLocations","locName","getMarkerClass","maxChar","renderByTime","_times","nowTime","filteredTimes","nowOnly","allTime","roundDateToDay","renderFavorites","_favorites","matchEvent","cEvent","allMatches","matchByTime","matchByDayAndPlace","sameDay","sameLocation","matchByDescription","adjustFavorites","startDate","endDate","startTime","endTime","renderSearchResults","searchResults","renderFloorPlan","floorPlanInteractive","showMap","markerCoords","clickableArea","allX","_","allY","minX","minY","getMarkerCoords","x","y","zoomButtonText","fullHref","startsWith","isExternalLink","URL","hostname","renderAsList","sortedEvents","e1","e2","dialogPolyfill","window","getServerSideThrower","isProp","error","Error","registerDialog","forceRegisterDialog","reposition","isInlinePositionSetByStylesheet","needsCentering","DialogManager","defineProperties","dm","get","formSubmitter","imagemapUseValue","supportCustomEvent","CustomEvent","safeDispatchEvent","target","check","dispatchEvent","findNearestDialog","el","localName","parentElement","parentNode","safeBlur","shadowRoot","activeElement","blur","inNodeList","nodeList","node","isFormMethodDialog","hasAttribute","getAttribute","findFocusableElementWithin","hostElement","query","Element","prototype","elems","tagName","isConnected","findFormSubmitter","submitter","form","HTMLFormElement","getRootNode","maybeHandleSubmit","defaultPrevented","dialog","preventDefault","close","dialogPolyfillInfo","dialog_","replacedStyleTop_","openAsModal_","setAttribute","show","bind","showModal","returnValue","MutationObserver","maybeHideModal","observe","attributes","attributeFilter","timeout","removed","cb","downgradeModal","delayModel","ev","cand","substr","clearTimeout","defineProperty","set","setOpen","backdrop_","createElement","backdropMouseEvent_","createEvent","initCustomEvent","bubbles","cancelable","detail","Event","style","zIndex","top","removeDialog","removeAttribute","focus","fake","insertBefore","firstChild","tabIndex","redirectedEvent","initMouseEvent","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","stopPropagation","focus_","updateZIndex","dialogZ","backdropZ","open","pushDialog","getComputedStyle","invalid","k","ok","undefined","opacity","position","webkitOverflowScrolling","createsStackingContext","nextSibling","opt_returnValue","closeEvent","scrollTop","documentElement","topValue","innerHeight","offsetHeight","styleSheets","styleSheet","cssRules","j","rule","selectedNodes","selectorText","cssTop","getPropertyValue","cssBottom","bottom","HTMLDialogElement","pendingDialogStack","checkDOM","checkDOM_","overlay","forwardTab_","handleKey_","handleFocus_","zIndexLow_","zIndexHigh_","mo_","records","rec","c","removedNodes","concat","blockDocument","childList","subtree","unblockDocument","removeEventListener","disconnect","updateStacking","dpi","last","appendChild","containedByTopDialog_","candidate","composedPath","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","keyCode","cancelEvent","indexOf","allowed","unshift","index","testForm","method","methodDescriptor","getOwnPropertyDescriptor","realGet","call","realSet","v","shift","offsetX","offsetY","nativeFormSubmit","submit","getRender","initializing","dataset","templateCache","css","breakpoint","getStyles","loadingTemplate","innerHTML","content","cloneNode","renderTable","list","showFloorPlan","view","tableTemplate","maximized","currentSearch","renderSearchBar","dialogs","classList","render","wrapper","handleScroll","SCROLLED_CLASS","scrollLeft","remove","replaceWith","floorPlanImage","scrollIntoView","block","setState","openEventDialog","eventJSON","decodeURIComponent","encodedEvent","pushState","override","l","toggleSortDialog","closeEventDialog","hash","toggleHiddenLocation","activeLocationEl","history","replaceState","hasFloorPlan","toggleFloorPlanInteractive","locationName","_bool","addOrRemove","showFloorPlanMessage","allHeaders","COLLAPSED_CLASS","header","dialogContent","newState","activeDate","hr","mn","roundedMn","newMn","prevName","nextName","message","messageEl","ACTIVE_CLASS","textContent","currentElement","overflow","prevState","divideIntoChunks","table","cols","chunks","container","thead","clone","tbody","cloneHeadRow","cloneBodyRows","allColumns","allRows","firstElementChild","th","tr","cloneTr","allCells","cellIdx","cell","column","cloneTable","cloned","printState","beforePrint","afterPrint","chunk","print","HTMLElement","Exports","ThunderEvents","Components","Image","super","attachShadow","mode","actionMap","handleEsc","getHandleEsc","handleHashChange","getHandleHashChange","getAddFavorite","getRemoveFavorite","getToggleHiddenLocation","getToggleAllHiddenLocations","getShowFloorPlan","getToggleFloorPlanInteractive","toggleHeaders","getToggleHeaders","getToggleSortDialog","getOpenEventDialog","getCloseEventDialog","selectActiveLocation","getSelectActiveLocation","selectActiveDay","getSelectActiveDay","selectActiveTime","getSelectActiveTime","selectSortBy","getSelectSortBy","changeSearch","getChangeSearch","getSearch","getShowFloorPlanMessage","maximize","getMaximize","undoStateChange","getUndoStateChange","getPrint","actionName","action","provideState","then","programGuideData","src","firstTime","connectedCallback","disconnectedCallback","options","_options","getCallback"],"mappings":"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"}